namespace = trollevt

#Regeneration
character_event = {
	id = trollevt.1
	desc = {
		trigger = {
			trait = wounded
		}
		text = EVTDESCTROLOLO.1a # Thanks to your natural regeneration powers, your wound has been healed without even a scar!
	}
	desc = {
		trigger = {
			OR = {
				trait = maimed
				trait = severely_injured
			}
		}
		text = EVTDESCTROLOLO.1b # Thanks to your natural regeneration powers, your greivous injuries are now well on the way to recovering completely.
	}
	desc = {
		trigger = {
			OR = {
				trait = one_eyed
				trait = one_handed
				trait = one_legged
				trait = disfigured
				trait = mangled
				trait = eunuch
				trait = blinded
			}
		}
		text = EVTDESCTROLOLO.1c # Thanks to your natural regeneration powers, your missing bodypart has begun to grow back!
	}
	picture = GFX_evt_recovery
	
	mean_time_to_happen = {
		months = 5
		modifier = {
			factor = 1.2
			health = 6
			NOT = { health = 7 }
		}
		modifier = {
			factor = 1.4
			health = 7
		}
		modifier = {
			factor = 0.8
			health = 3
			NOT = { health = 4 }
		}
		modifier = {
			factor = 0.6
			health = 2
			NOT = { health = 3 }
		}
		modifier = {
			factor = 0.7
			is_ill = yes
		}
		modifier = {
			factor = 1.5
			OR = {
				trait = maimed
				trait = severely_injured
			}
		}
		modifier = {
			factor = 3.5
			OR = {
				trait = one_eyed
				trait = one_handed
				trait = one_legged
				trait = disfigured
				trait = mangled
				trait = eunuch
				trait = blinded
			}
		}
		modifier = {
			factor = 0.3
			NOT = { piety = 1 }
		}
	}
		
	trigger = {
		OR = {
			trait = troll_zandalari
			trait = troll_jungle
			trait = troll_forest
			trait = troll_ice
			trait = troll_sand
			trait = troll_dark
		}
		NOR = {
			trait = undead_scourge
			trait = undead_forsaken
			trait = undead_generic
		}
		OR = {
			trait = wounded
			trait = maimed
			trait = severely_injured
			trait = one_eyed
			trait = one_handed
			trait = one_legged
			trait = disfigured
			trait = mangled
			trait = eunuch
			trait = blinded
		}
	}
	
	option = {
		name = AKGREAT
		if = {
			limit = {
				OR = {
					trait = one_eyed
					trait = one_handed
					trait = one_legged
					trait = disfigured
					trait = mangled
					trait = eunuch
					trait = blinded
				}
			}
			random_list = {
				1 = {
					modifier = {
						factor = 0
						NOT = { trait = one_eyed }
					}
					remove_trait = one_eyed
				}
				1 = {
					modifier = {
						factor = 0
						NOT = { trait = one_handed }
					}
					remove_trait = one_handed
				}
				1 = {
					modifier = {
						factor = 0
						NOT = { trait = one_legged }
					}
					remove_trait = one_legged
				}
				1 = {
					modifier = {
						factor = 0
						NOT = { trait = disfigured }
					}
					remove_trait = disfigured
				}
				1 = {
					modifier = {
						factor = 0
						NOT = { trait = mangled }
					}
					remove_trait = mangled
				}
				1 = {
					modifier = {
						factor = 0
						NOT = { trait = eunuch }
					}
					remove_trait = eunuch
				}
				1 = {
					modifier = {
						factor = 0
						NOT = { trait = blinded }
					}
					remove_trait = blinded
				}
			}
			break = yes
		}
		if = {
			limit = {
				trait = severely_injured
			}
			remove_trait = severely_injured
			add_trait = wounded
			break = yes
		}
		if = {
			limit = {
				trait = maimed
			}
			remove_trait = maimed
			add_trait = wounded
			break = yes
		}
		if = {
			limit = {
				trait = wounded
			}
			remove_trait = wounded
			break = yes
		}
	}
}

#Hakkari to Gurubashi
character_event = {
	id = trollevt.2
	hide_window = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	trigger = {
		culture = hakkari
		NOT = { religion = hakkar }
	}
	
	immediate = {
		culture = gurubashi
	}
}

#Born as dire troll
#Ping
character_event = {
	id = trollevt.3
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			trait = troll_dark
			trait = troll_zandalari
			trait = troll_sand
			trait = troll_forest
			trait = troll_ice
			trait = troll_jungle
			mother_even_if_dead = {
				OR = {
					trait = troll_dark
					trait = troll_zandalari
					trait = troll_sand
					trait = troll_forest
					trait = troll_ice
					trait = troll_jungle
				}
			}
		}
		NOT = { trait = dire_troll }
	}
	
	immediate = {
		add_trait = dire_troll
		father = {
			if = {
				limit = {
					is_alive = yes
					ai = no
				}
				character_event = { id = trollevt.4 }
			}
		}
		mother = {
			if = {
				limit = {
					is_alive = yes
					ai = no
				}
				character_event = { id = trollevt.4 }
			}
		}
	}
}

#Parents
character_event = {
	id = trollevt.4
	desc = EVTDESCTROLOLO.4 # Your [From.GetSonDaughter] [From.GetFirstName] has been born particularly big, and everything indicates [From.GetSheHe] will become a mighty dire troll when [From.GetSheHe] grows up!
	picture = GFX_evt_dire_troll
	
	is_triggered_only = yes
	
	option = {
		name = OK
		FROM = {
			add_trait = dire_troll
		}
	}
}

#An offer you can't refuse
character_event = {
	id = trollevt.5
	desc = EVTDESCTROLOLO.5 # Your captor, [From.GetTitledName], has come to you with an offer: swear fealty to [From.GetHerHim] and be freed, or languish in prison.
	picture = GFX_evt_throne_room
	border = GFX_event_normal_frame_diplomacy	
	
	is_triggered_only = yes
	
	option = {
		ai_chance = {
			factor = 1
			modifier = {
				factor = 1.1
				trait = depressed
			}
			modifier = {
				factor = 2
				NOT = {
					liege = {
						opinion = { who = ROOT value = 0 }
					}
				}
			}
			modifier = {
				factor = 3
				is_friend = FROM
			}
			modifier = {
				factor = 3
				liege = {
					is_rival = ROOT
				}
			}
			modifier = {
				factor = 3
				dynasty = FROM
			}
			modifier = {
				factor = 1.5
				trait = craven
			}
		}
		name = EVTOPTTROLOLO.5a # Very well.
		set_defacto_liege = FROM
	}
	
	option = {
		ai_chance = {
			factor = 3
			modifier = {
				factor = 1.5
				prestige = 500
				NOT = { prestige = 1000 }
			}
			modifier = {
				factor = 3
				prestige = 1000
			}
			modifier = {
				factor = 1.5
				NOT = { religion = FROM }
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
		}
		name = EVTOPTTROLOLO.5b # I won't kneel to you.
		add_character_modifier = { name = asked_to_bend_knee duration = 150 }
	}
}

#Zandalari maintenance
character_event = {
	id = trollevt.6
	hide_window = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	trigger = {
		trait = troll_zandalari
		religion = loa
		NOT = { culture = zandalari }
	}
	
	immediate = {
		culture = zandalari
	}
}

#Form Zul
character_event = {
	id = trollevt.7
	title = EVTTITLETROLOLO.7 # The Empire of Zul
	desc = EVTDESCTROLOLO.7 # With all troll empires in your grip, you are poised to restore the ancient Empire of Zul, that once stood alone against the dread Aqir long before the Sundering.
	picture = GFX_evt_zandalari_meeting
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		activate_title = { title = e_zandalar status = yes }
		e_zul = {
			grant_title = ROOT
		}
	}
	
	option = {
		name = OK
		any_playable_ruler = {
			limit = {
				ai = no
			}
			character_event = { id = trollevt.8 }
		}
	}
}

character_event = {
	id = trollevt.8
	title = EVTTITLETROLOLO.7 # The Empire of Zul
	desc = EVTDESCTROLOLO.8 # [From.GetTitledName] has done what was though impossible. [From.GetSheHe] has united all the troll empires under the banner of the ancient Empire of Zul.
	picture = GFX_evt_zandalari_meeting
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}