#########################################################
#
# Landless Character Adventures for The Old Gods DLC
# ( TOG.1200 to TOG.1499)
#
#
#########################################################

# Written by Henrik Fåhraeus

namespace = TOG

# An ambitious landless claimant begins to plan an adventure for the title
character_event = {
	id = TOG.1200
	
	hide_window = yes # Only fires for unplayable landless characters
	
	min_age = 16
	max_age = 50
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Old Gods"
		
		NOT = {
			has_game_rule = {
				name = adventurers
				value = none
			}
		}

		OR = {
			is_female = no
			liege = { has_law = status_of_women_4 }
			liege = { has_law = true_cognatic_succession }
			liege = { religion = cathar }
			liege = { religion = messalian }
			has_game_rule = {
				name = gender
				value = all
			}
			AND = {
				trait = ambitious
				has_education_martial_trigger = yes
				OR = {
					trait = genius
					diplomacy = 16
					AND = {
						diplomacy = 12
						martial = 16
					}
				}
			}
		}
		
		TOW_is_landless_claimant_adventurer_valid = yes

		diplomacy = 7
		
		health = 4
		NOT = { trait = content }
		NOT = { trait = craven }
		
		NOT = { has_character_modifier = planning_claimant_adventure }
		NOT = { has_character_flag = TOW_preparing_adventure }
	}
	
	mean_time_to_happen = {
		years = 50
		modifier = {
			factor = 0.2
			has_character_flag = flag_denied_title
		}
		modifier = {
			factor = 0.5
			trait = ambitious
		}
		modifier = {
			factor = 0.2
			has_character_flag = demon_child_non_pagan
		}
		modifier = {
			factor = 0.5
			trait = envious
		}
		modifier = {
			factor = 0.75
			diplomacy = 12
		}
		modifier = {
			factor = 0.75
			trait = brave
		}
		modifier = {
			factor = 0.75
			trait = born_in_the_purple
		}
		modifier = {
			factor = 0.85
			trait = proud
		}
		modifier = {
			factor = 0.85
			trait = sayyid
		}
		modifier = {
			factor = 1.5
			trait = slothful
		}
		modifier = {
			factor = 1.5
			trait = humble
		}
		modifier = {
			factor = 2.0
			trait = kind
		}
		modifier = {
			factor = 0.9
			is_smart_trigger = yes
		}
		modifier = {
			factor = 0.8
			trait = genius
		}
		modifier = {
			factor = 0.95
			is_strong_trigger = yes
		}
		modifier = {
			factor = 1.2
			is_dumb_trigger = yes
		}
		modifier = {
			factor = 1.1
			is_weak_trigger = yes
		}
		modifier = {
			factor = 1.5
			character_disease_trigger = yes
		}
		modifier = {
			factor = 0.02
			check_variable = { which = "TOW_adventure_manpower" value = 60 } # I already started a good adventure that didn't end !
		}
		modifier = {
			factor = 50
			has_game_rule = {
				name = adventurers
				value = rare
			}
		}
	}
	
	immediate = {
		random_claim = {
			limit = {
				has_holder = yes
				holder_scope = {
					independent = yes # Only do this vs independent rulers
					NAND = {
						government = nomadic_government
						OR = {
							clan_title = {
								title = PREVPREV
							}
							primary_title = {
								title = PREVPREV
							}
						}
					}
					OR = {
						# Don't target my liege unless I am ambitious
						NOT = { is_vassal_or_below = ROOT }
						ROOT = { trait = ambitious }
					}
					OR = {
						is_merchant_republic = no
						NOT = {
							capital_holding = {
								de_jure_liege_or_above = PREVPREV
							}
						}
					}
				}
				OR = {
					tier = KING
					holder_scope = { tier = PREV }
				}
			}
			
			holder_scope = {
				save_event_target_as = adventure_target
				reverse_opinion = {
					who = ROOT
					years = 3
					modifier = opinion_claimant_adventure_target
				}
				character_event = {
					id = TOG.1201 # Warn the target
				}
			}
			ROOT = {
				add_character_modifier = {
					name = planning_claimant_adventure
					hidden = yes
					days = 730
				}
				character_event = {
					id = TOG.1202 # Fire the attack
					days = 730
				}
			}
			
			if = {
				limit = {
					holder_scope = {
						is_vassal_or_below = ROOT
					}
				}
				ROOT = { banish = yes } # Can't prepare for the attack from within the realm
			}
		}

		end_inaccessibility_effect = yes #removes in hiding or in_seclusion
		
		set_character_flag = do_not_disturb
		set_character_flag = TOW_preparing_adventure
		set_character_flag = TOW_prepared_adventure
		set_variable = { which = "TOW_adventure_manpower" value = 0 }
		set_variable = { which = "TOW_adventure_realm_asked" value = 0 }
		log = "-- TOW DEBUG -- : Adventure : [Root.GetBestName] starts adventure"
		character_event = { id = TOG.1215 days = 730 }
	}
}

## Target warned of the adventurer
character_event = {
	id = TOG.1201
	desc = EVTDESC_TOG_1201
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		opinion = {
			who = FROM
			modifier = opinion_targeted_by_adventurer
			months = 24
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1201"
	}
}

# An ambitious landless claimant starts an adventure for the title
character_event = {
	id = TOG.1202
	
	hide_window = yes # Only fires for unplayable landless characters
	
	is_triggered_only = yes

	capable_only = yes
	prisoner = no
	
	trigger = {
		TOW_is_landless_claimant_adventurer_valid = yes

		event_target:adventure_target = {
			is_alive = yes
			is_ruler = yes

			NOT = {
				any_demesne_title = {
					claimed_by = ROOT
					OR = {
						tier = KING
						holder_scope = { tier = PREV }
					}
					holder_scope = {
						defending_against_claimant = {
							character = ROOT
							title = PREV
						}
					}
				}
			}

			independent = yes # Only do this vs independent rulers
			NAND = {
				government = nomadic_government
				OR = {
					clan_title = {
						title = PREVPREV
					}
					primary_title = {
						title = PREVPREV
					}
				}
			}
			reverse_has_opinion_modifier = {
				who = ROOT
				modifier = opinion_claimant_adventure_target
			}
			OR = {
				is_merchant_republic = no
				NOT = {
					capital_holding = {
						de_jure_liege_or_above = PREVPREV
					}
				}
			}
			ROOT = {
				NOR = {
					obedient = PREV
					non_interference = PREV
				}
			}
			any_demesne_title = {
				claimed_by = ROOT
				OR = {
					tier = KING
					holder_scope = { tier = PREV }
				}
			}
		}
	}
	
	immediate = {
		clr_character_flag = do_not_disturb

		TOW_adventurers_manpower_factors = yes

		## Didn't gather enough people, just abandon
		if = {
			limit = {
				NOT = { check_variable = { which = TOW_adventure_manpower value = 40 } }
			}
			log = "-- TOW DEBUG -- : Adventure : [Root.GetBestName] gave up, he had only [Root.TOW_adventure_manpower.GetValue]% of the target's manpower."

			break = yes
		}

		prestige = 100
        add_trait = adventurer
		
		liege = {
			character_event = {
				id = TOG.1203
				days = 1
			}
		}
		
		liege = {
			capital_scope = {
				save_event_target_as = starting_province
			}
		}

		set_defacto_liege = ROOT
		create_title = {
			tier = DUKE
			landless = yes
			temporary = yes
			adventurer = yes
			culture = ROOT
			name = "CLAIMANT_ADVENTURE"
			holder = ROOT
		}
		
		event_target:starting_province = {
			event_target:adventure_target = {
				ROOT = {
					TOW_adventurers_spawn_unit_with_manpower = yes
				}
			}
		}

		event_target:adventure_target = {
			random_demesne_title = {
				limit = {
					claimed_by = ROOT
					OR = {
						tier = KING
						holder_scope = { tier = PREV }
					}
				}
				save_event_target_as = adventure_target_title
			}
		}
		
		# Create some decent commander characters
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 30
		}
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 25
		}
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
		}
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
		}


		# Create a fleet, just to be sure
		TOW_adventurers_spawn_fleet_with_manpower = yes

		export_to_variable = { which = "TOW_TMP" value = treasury }
		log = "-- TOW DEBUG -- : Adventure : [Root.GetBestName] declares war on [adventure_target.GetTitledName] for the [adventure_target_title.GetFullName] from the province [starting_province.GetName], [Root.GetSheHe] has [Root.TOW_adventure_manpower.GetValue]% of the target's manpower, [Root.GetSheHe] asked help from [Root.TOW_adventure_realm_asked.GetValue] realms and [Root.GetSheHe] has [Root.TOW_TMP.GetValue] money."

		set_character_flag = claimant_adventurer
		
		event_target:adventure_target = {
			reverse_war = {
				target = ROOT
				casus_belli = claim
				thirdparty_title = event_target:adventure_target_title
			}
			reverse_remove_opinion = {
				who = ROOT
				modifier = opinion_claimant_adventure_target
			}
		}
	}

	after = {
		TOW_clear_landless_claimant_adventure = yes
	}
}

character_event = {
	id = TOG.1203
	desc = EVTDESC_TOG_1203
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { is_ruler = yes } # The DoW worked and the adventurer has a temporary title
	}
	
	immediate = {
		any_liege = {
			character_event = {
				id = TOG.1204
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1203"
	}
}

character_event = {
	id = TOG.1204
	desc = EVTDESC_TOG_1204
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	show_from_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1203"
	}
}

# An ambitious character with no inheritance begins to plan an adventure for a foreign title
character_event = {
	id = TOG.1210
	
	hide_window = yes # Only fires for unplayable landless characters
	
	min_age = 16
	max_age = 50
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Old Gods"
		
		NOT = {
			has_game_rule = {
				name = adventurers
				value = none
			}
		}
		
		is_ruler = no
		NOT = { any_spouse = { is_ruler = yes } }

		OR = {
			is_female = no
			liege = { has_law = status_of_women_4 }
			liege = { has_law = true_cognatic_succession }
			liege = { religion = cathar }
			liege = { religion = messalian }
			has_game_rule = {
				name = gender
				value = all
			}
			AND = {
				trait = ambitious
				has_education_martial_trigger = yes
				OR = {
					trait = genius
					diplomacy = 14
					AND = {
						diplomacy = 10
						martial = 16
					}
				}
			}
		}
		
#		year = 867
		
		diplomacy = 7
		martial = 9
		health = 4
		
		NOT = { trait = content }
		NOT = { trait = craven }
		
		OR = { # Only these for now
			culture_group = north_germanic
			culture_group = west_germanic
			culture_group = altaic
			culture = norman
			culture = frankish
			culture = breton
			culture = catalan
			AND = {
				culture = hungarian
				NOT = { year = 1066 }
			}
			has_character_flag = demon_child_non_pagan
		}
		
		NOT = { # Somewhat clunky way of checking that the character does not stand to inherit any titles
			any_heir_title = {
				always = yes
			}
		}
		
		NOT = { # Handled by event TOG.1200
			any_claim = {
				has_holder = yes
				holder_scope = {
					independent = yes
					OR = {
						is_merchant_republic = no
						NOT = {
							capital_holding = {
								de_jure_liege_or_above = PREVPREV
							}
						}
					}
				}
				OR = {
					tier = KING
					holder_scope = { tier = PREV }
				}
				ROOT = {
					NOR = {
						obedient = PREV
						non_interference = PREV
					}
				}
			}
		}
		
		OR = {
			father_even_if_dead = {
				OR = {
					primary_title = { higher_tier_than = BARON }
					father_even_if_dead = {
						primary_title = { higher_tier_than = BARON }
					}
					mother_even_if_dead = {
						primary_title = { higher_tier_than = BARON }
					}
				}
			}
			mother_even_if_dead = {
				OR = {
					primary_title = { higher_tier_than = BARON }
					father_even_if_dead = {
						primary_title = { higher_tier_than = BARON }
					}
					mother_even_if_dead = {
						primary_title = { higher_tier_than = BARON }
					}
				}
			}
		}
		
		NOT = { has_character_modifier = planning_duchy_adventure }
	}
	
	mean_time_to_happen = {
		years = 100
		modifier = {
			factor = 4
			has_dlc = "Horse Lords"
			is_allowed_to_loot = yes
		}
		modifier = {
			factor = 0.5
			trait = ambitious
		}
		modifier = {
			factor = 0.5
			OR = {
				AND = {
					culture = norman
					NOT = { year = 1250 }
				}
				AND = {
					culture_group = north_germanic
					NOT = { year = 1066 }
				}
			}
		}
		modifier = {
			factor = 0.2
			has_character_flag = flag_denied_title
		}
		modifier = {
			factor = 0.2
			has_character_flag = demon_child_non_pagan
		}
		modifier = {
			factor = 0.75
			diplomacy = 12
		}
		modifier = {
			factor = 0.75
			martial = 12
		}
		modifier = {
			factor = 0.75
			trait = brave
		}
		modifier = {
			factor = 0.85
			trait = proud
		}
		modifier = {
			factor = 3.0
			trait = slothful
		}
		modifier = {
			factor = 3.0
			trait = humble
		}
		modifier = {
			factor = 3.0
			trait = kind
		}
		modifier = {
			factor = 3.0
			any_liege = {
				ai = no
			}
		}
		modifier = {
			factor = 3.0
			top_liege = {
				tier = emperor
			}
		}
		modifier = {
			factor = 0.9
			is_smart_trigger = yes
		}
		modifier = {
			factor = 0.8
			trait = genius
		}
		modifier = {
			factor = 0.95
			is_strong_trigger = yes
		}
		modifier = {
			factor = 1.2
			is_dumb_trigger = yes
		}
		modifier = {
			factor = 1.1
			is_weak_trigger = yes
		}
		modifier = {
			factor = 1.5
			character_disease_trigger = yes
		}
		modifier = {
			factor = 50
			has_game_rule = {
				name = adventurers
				value = rare
			}
		}
	}
	
	immediate = {
		random_independent_ruler = {
			limit = {
				NOT = { culture = ROOT }
				is_landed = yes
				independent = yes
				NOT = { is_vassal_or_below = ROOT }
				any_realm_province = {
					OR = {
						AND = {
							port = yes
							ROOT = {
								NOT = { culture_group = altaic }
								NOT = { culture = hungarian }
							}
							NOT = {
								distance = {
									who = ROOT
									value = 800
								}
							}
						}
						any_neighbor_province = {
							owner = {
								same_realm = ROOT
							}
						}
					}
					NOT = {
						region = world_europe_north
					}
					NOT = {
						duchy = {
							title = d_bjarmia
						}
					}
				}
				ROOT = {
					NOR = {
						obedient = PREV
						non_interference = PREV
					}
				}
			}
			
			random_realm_province = {
				limit = {
					OR = {
						AND = {
							port = yes
							ROOT = {
								NOT = { culture_group = altaic }
								NOT = { culture = hungarian }
							}
							NOT = {
								distance = {
									who = ROOT
									value = 800
								}
							}
						}
						any_neighbor_province = {
							owner = {
								same_realm = ROOT
							}
						}
					}
					NOT = {
						region = world_europe_north
					}
					NOT = {
						duchy = {
							title = d_bjarmia
						}
					}
				}
				
				ROOT = {
					opinion = {
						who = PREVPREV
						years = 3
						modifier = opinion_duchy_adventure_target
					}
					add_character_modifier = {
						name = planning_duchy_adventure
						hidden = yes
						days = 730
					}
					character_event = {
						id = TOG.1212 # Fire the attack
						days = 730
					}
				}
				PREV = {
					character_event = {
						id = TOG.1211 # Warn the target
					}
				}
			}
		}
		end_inaccessibility_effect = yes #removes in hiding or in_seclusion
		
		character_event = { id = TOG.1215 days = 730 }
	}
}

character_event = {
	id = TOG.1211
	desc = EVTDESC_TOG_1211
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		opinion = {
			who = FROM
			modifier = opinion_targeted_by_adventurer
			months = 24
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1211"
	}
}

# An ambitious character with no inheritance starts an adventure for a foreign title
# (Temporary title created and a war declared)
character_event = {
	id = TOG.1212
	
	hide_window = yes # Only fires for unplayable landless characters
	
	is_triggered_only = yes

	prisoner = no
	only_capable = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		
		is_ruler = no
		NOT = { any_spouse = { is_ruler = yes } }
		
		NOT = {
			any_heir_title = {
				always = yes
			}
		}
		
		any_independent_ruler = {
			NOT = { culture = ROOT }
			is_landed = yes
			independent = yes
			NOT = { is_vassal_or_below = ROOT }
			any_realm_province = {
				OR = {
					AND = {
						port = yes
						ROOT = {
							NOT = { culture_group = altaic }
							NOT = { culture = hungarian }
						}
					}
					any_neighbor_province = {
						owner = {
							same_realm = ROOT
						}
					}
				}
				NOT = {
					region = world_europe_north
				}
				NOT = {
					duchy = {
						title = d_bjarmia
					}
				}
			}
			ROOT = {
				NOR = {
					obedient = PREV
					non_interference = PREV
				}
			}
			reverse_has_opinion_modifier = {
				who = ROOT
				modifier = opinion_duchy_adventure_target
			}
		}
	}
	
	immediate = {
		wealth = 500
		clr_character_flag = do_not_disturb
		
		liege = {
			character_event = {
				id = TOG.1213
				days = 1
			}
		}
		
		liege = {
			capital_scope = {
				random_independent_ruler = {
					limit = {
						NOT = { culture = ROOT }
						is_landed = yes
						independent = yes
						NOT = { is_vassal_or_below = ROOT }
						any_realm_province = {
							OR = {
								AND = {
									port = yes
									ROOT = {
										NOT = { culture_group = altaic }
										NOT = { culture = hungarian }
									}
								}
								any_neighbor_province = {
									owner = {
										same_realm = ROOT
									}
								}
							}
							NOT = {
								region = world_europe_north
							}
							NOT = {
								duchy = {
									title = d_bjarmia
								}
							}
						}
						ROOT = {
							NOR = {
								obedient = PREV
								non_interference = PREV
							}
						}
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_duchy_adventure_target
						}
					}
					random_realm_province = {
						limit = {
							OR = {
								AND = {
									port = yes
									ROOT = {
										NOT = { culture_group = altaic }
										NOT = { culture = hungarian }
									}
								}
								any_neighbor_province = {
									owner = {
										same_realm = ROOT
									}
								}
							}
							NOT = {
								region = world_europe_north
							}
							NOT = {
								duchy = {
									title = d_bjarmia
								}
							}
						}
						
						ROOT = {
							set_defacto_liege = ROOT
							create_title = {
								tier = DUKE
								landless = yes
								temporary = yes
								adventurer = yes
								culture = ROOT
								name = "CLAIMANT_ADVENTURE"
								holder = ROOT
							}
							
							set_character_flag = duchy_adventurer
						
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = THIS
								#leader = THIS
								match_character = PREVPREV
								match_mult = 0.125
								match_min = 500
								match_max = 10000
								attrition = 0.25
							}
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = THIS
								match_character = PREVPREV
								match_mult = 0.125
								match_min = 500
								match_max = 10000
								attrition = 0.25
							}
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = THIS
								match_character = PREVPREV
								match_mult = 0.125
								match_min = 500
								match_max = 10000
								attrition = 0.25
							}
							war = {
								target = PREVPREV
								casus_belli = duchy_adventure
								thirdparty_title = PREV
								tier = DUKE
							}
							remove_opinion = {
								who = PREVPREV
								modifier = opinion_duchy_adventure_target
							}
						}
					}
				}
			}
		}
		
		# Create some decent commander characters
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 30
		}
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 25
		}
		
		if  = {
			limit = {
				NOT = { culture_group = altaic }
				NOT = { culture = hungarian }
			}
			
			# Create a fleet, just to be sure
			spawn_fleet = {
				province = closest # closest sea zone
				owner = ROOT
				disband_on_peace = yes
				troops =
				{
					galleys = { 200 200 }
				}
			}
		}
	}
}

character_event = {
	id = TOG.1213
	desc = EVTDESC_TOG_1213
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { is_ruler = yes } # The DoW worked and the adventurer has a temporary title
	}
	
	immediate = {
		FROM = {
			add_trait = adventurer
		}
		any_liege = {
			character_event = {
				id = TOG.1214
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1203"
	}
}

character_event = {
	id = TOG.1214
	desc = EVTDESC_TOG_1214
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	show_from_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1203"
	}
}

#safety clear of DND
character_event = {
	id = TOG.1215
	
	is_triggered_only = yes
	
	hide_window = yes
	
	immediate = {
		clr_character_flag = do_not_disturb
	}
}

############################
### TOW ADDED EVENTS ###
############################

### Adding troops randomly
character_event = {
	id = TOG.1216

	hide_window = yes

	has_character_flag = TOW_preparing_adventure
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Old Gods"
		
		NOT = {
			has_game_rule = {
				name = adventurers
				value = none
			}
		}
		has_character_flag = TOW_preparing_adventure
	}
	
	mean_time_to_happen = {
		days = 90
		modifier = {
			factor = 1.1
			check_variable = { which = "TOW_adventure_manpower" value = 50 }
		}
		modifier = {
			factor = 1.2
			check_variable = { which = "TOW_adventure_manpower" value = 75 }
		}
		modifier = {
			factor = 1.6
			check_variable = { which = "TOW_adventure_manpower" value = 100 }
		}
		modifier = {
			factor = 2
			check_variable = { which = "TOW_adventure_manpower" value = 150 }
		}
		modifier = {
			factor = 0.95
			has_character_flag = flag_denied_title
		}
		modifier = {
			factor = 0.9
			trait = ambitious
		}
		modifier = {
			factor = 0.85
			trait = brave
		}
		modifier = {
			factor = 1.75
			trait = slothful
		}
		modifier = {
			factor = 0.9
			trait = kind
		}
		modifier = {
			factor = 0.9
			is_smart_trigger = yes
		}
		modifier = {
			factor = 0.9
			trait = genius
		}
		modifier = {
			factor = 0.9
			is_strong_trigger = yes
		}
		modifier = {
			factor = 1.3
			is_dumb_trigger = yes
		}
		modifier = {
			factor = 1.1
			is_weak_trigger = yes
		}
		modifier = {
			factor = 1.25
			character_disease_trigger = yes
		}
		modifier = {
			factor = 1.25
			trait = gregarious
		}
		modifier = {
			factor = 1.1
			trait = socializer
		}
	}
	
	immediate = {
		## Check validity
		if = {
			limit = {
				TOW_is_landless_claimant_adventurer_valid = no
			}

			TOW_clear_landless_claimant_adventure = yes
			break = yes
		}

		set_variable = { which = "TOW_TMP" value = 1 } # base value
		if = {
			limit = { diplomacy = 9 }
			export_to_variable = { which = "TOW_TMP" value = diplomacy }
			subtract_variable = { which = "TOW_TMP" value = 8 }
			divide_variable = { which = "TOW_TMP" value = 12 }
			change_variable = { which = "TOW_TMP" value = 1 } # base value
		}

		if = {
			limit = { martial = 9 }
			export_to_variable = { which = "TOW_TMP2" value = martial }
			subtract_variable = { which = "TOW_TMP2" value = 8 }
			divide_variable = { which = "TOW_TMP2" value = 18 }

			change_variable = { which = "TOW_TMP" which = "TOW_TMP2" }
		}

		random_list = {
			3 = { multiply_variable = { which = "TOW_TMP" value = 4 } }
			6 = { multiply_variable = { which = "TOW_TMP" value = 5 } }
			3 = { multiply_variable = { which = "TOW_TMP" value = 6 } }
		}
		
		change_variable = { which = "TOW_adventure_manpower" which = "TOW_TMP" }
		TOW_landless_claimant_adventurer_update_modifier = yes

		export_to_variable = { which = "TOW_TMP" value = stewardship }
		random_list = {
			1 = { change_variable = { which = "TOW_TMP" value = 1 } }
			1 = { change_variable = { which = "TOW_TMP" value = 2 } }
			1 = { change_variable = { which = "TOW_TMP" value = 3 } }
		}
		while = {
			limit = { check_variable = { which = "TOW_TMP" value = 1 } }
			wealth = 1
			subtract_variable = { which = "TOW_TMP" value = 1 }
		}

	}
}


### Asking for support from a ruler - selecting event
character_event = {
	id = TOG.1217

	hide_window = yes

	has_character_flag = TOW_preparing_adventure
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Old Gods"
		
		NOT = {
			has_game_rule = {
				name = adventurers
				value = none
			}
		}

		has_character_flag = TOW_preparing_adventure
		NOT = { has_character_flag = TOW_adventure_asking_realm }
	}
	
	mean_time_to_happen = {
		months = 10
		modifier = {
			factor = 0.9
			has_character_flag = flag_denied_title
		}
		modifier = {
			factor = 0.9
			trait = ambitious
		}
		modifier = {
			factor = 0.8
			trait = diligent
		}
		modifier = {
			factor = 0.9
			trait = brave
		}
		modifier = {
			factor = 2
			trait = slothful
		}
		modifier = {
			factor = 0.95
			is_smart_trigger = yes
		}
		modifier = {
			factor = 0.9
			trait = genius
		}
		modifier = {
			factor = 1.5
			is_dumb_trigger = yes
		}
		modifier = {
			factor = 1.5
			character_disease_trigger = yes
		}
		modifier = {
			factor = 1.2
			check_variable = { which = "TOW_adventure_manpower" value = 100 }
		}
		modifier = { factor = 0.75 NOT = { check_variable = { which = "TOW_adventure_realm_asked" value = 1 } } }
		modifier = { factor = 0.9 NOT = { check_variable = { which = "TOW_adventure_realm_asked" value = 3 } } }
		modifier = { factor = 0.9 NOT = { check_variable = { which = "TOW_adventure_realm_asked" value = 5 } } }
		modifier = { factor = 0.95 NOT = { check_variable = { which = "TOW_adventure_realm_asked" value = 10 } } }
	}
	
	immediate = {
		## Check validity
		if = {
			limit = {
				TOW_is_landless_claimant_adventurer_valid = no
			}

			TOW_clear_landless_claimant_adventure = yes
			break = yes
		}

		# Ask support where i am first (if the ruler doesn't hold any of my claimed titles)
		location = {
			county = {
				holder_scope = {
					top_liege = {
						if = {
							limit = {
								is_nomadic = no
								NOT = { is_foe = ROOT }
								ROOT = {
									NOT = { has_character_flag = TOW_adventure_asked_@PREV }
									NOT = {
										any_claim = {
											holder = PREVPREV
										}
									}
								}
							}
							character_event = {
								id = TOG.1218 # Ask the target
							}
							break = yes
						}
					}
				}
			}
		}
		# Ask support from a nearby realm
		random_independent_ruler = {
			limit = {
				is_inaccessible_trigger = no
				is_within_diplo_range = ROOT
				is_nomadic = no
				NOT = { is_foe = ROOT }
				ROOT = {
					NOT = { has_character_flag = TOW_adventure_asked_@PREV }
					NOT = { any_claim = { holder = PREVPREV } }
				}
				any_realm_province = {
					NOT = {
						ROOT = {
							location = {
								distance = { where = PREVPREV value = 400 }
							}
						}
					}
				}
			}
			character_event = {
				id = TOG.1218 # Ask the target
			}
		}
	}
}

## Independent ruler is asked for help
character_event = {
	id = TOG.1218

	desc = {
		text = EVTDESC_TOG_1218
		trigger = {
			NOR = {
				dynasty = FROM
				is_friend = FROM
				is_lover = FROM
			}
		}
	}
	desc = {
		text = EVTDESC_TOG_1218_CLOSE
		trigger = {
			OR = {
				dynasty = FROM
				is_friend = FROM
				is_lover = FROM
			}
		}
	}
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	immediate = {
		FROM = {
			set_character_flag = TOW_adventure_asking_realm ## Prevents asking multiple realms at once in multiplayer
			set_character_flag = TOW_adventure_asked_@ROOT
			change_variable = { which = "TOW_adventure_realm_asked" value = 1 }
		}
	}
	
	option = { ## Send money
		name = "EVTOPTA_TOG_1218"

		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				NOT = { wealth = 1 }
				NOT = { trait = charitable }
			}
			modifier = { factor = 1.1 opinion = { who = FROM value = 10 } }
			modifier = { factor = 1.1 opinion = { who = FROM value = 20 } }
			modifier = { factor = 1.1 opinion = { who = FROM value = 30 } }
			modifier = { factor = 1.1 opinion = { who = FROM value = 40 } }
			modifier = { factor = 1.1 opinion = { who = FROM value = 50 } }
			modifier = { factor = 1.15 opinion = { who = FROM value = 60 } }
			modifier = { factor = 1.15 opinion = { who = FROM value = 70 } }
			modifier = { factor = 1.15 opinion = { who = FROM value = 80 } }
			modifier = { factor = 1.15 opinion = { who = FROM value = 90 } }
			modifier = { factor = 0 trait = envious }
			modifier = { factor = 2 trait = trusting }
			modifier = { factor = 1.1 FROM = { diplomacy = 9 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 10 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 11 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 12 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 13 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 14 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 15 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 16 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 17 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 18 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 19 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 20 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 21 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 22 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 23 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 24 } }
			modifier = { factor = 2 is_lover = FROM }
			modifier = { factor = 2 dynasty = FROM }
			modifier = { factor = 1.5 is_close_relative = FROM }
		}

		wealth = -75

		custom_tooltip = {
			text = TOW_TOG_1218_support_custom_tooltip
			hidden_tooltip = {
				FROM = {
					random_list = {
						3 = { change_variable = { which = "TOW_adventure_manpower" value = 6 } modifier = { factor = 0.5 stewardship = 12 } }
						4 = { change_variable = { which = "TOW_adventure_manpower" value = 7 } modifier = { factor = 0.5 stewardship = 15 } }
						5 = { change_variable = { which = "TOW_adventure_manpower" value = 8 } modifier = { factor = 0.5 stewardship = 18 } }
						4 = { change_variable = { which = "TOW_adventure_manpower" value = 9 } modifier = { factor = 0.5 stewardship = 21 } }
						2 = { change_variable = { which = "TOW_adventure_manpower" value = 10 } }
					}
					TOW_landless_claimant_adventurer_update_modifier = yes
					move_character = ROOT
					wealth = 15 # Don't worry, the rest is put to good use
					set_character_flag = TOW_adventure_helped_by_@ROOT
				}
			}
		}

		reverse_opinion = { modifier = TOW_opinion_helped_my_adventure who = FROM years = 10 }
	}

	option = { ## Send troops
		name = "EVTOPTB_TOG_1218"

		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.25
				war = yes
			}
			modifier = { factor = 1.1 opinion = { who = FROM value = 10 } }
			modifier = { factor = 1.1 opinion = { who = FROM value = 20 } }
			modifier = { factor = 1.1 opinion = { who = FROM value = 30 } }
			modifier = { factor = 1.1 opinion = { who = FROM value = 40 } }
			modifier = { factor = 1.1 opinion = { who = FROM value = 50 } }
			modifier = { factor = 1.15 opinion = { who = FROM value = 60 } }
			modifier = { factor = 1.15 opinion = { who = FROM value = 70 } }
			modifier = { factor = 1.15 opinion = { who = FROM value = 80 } }
			modifier = { factor = 1.15 opinion = { who = FROM value = 90 } }
			modifier = { factor = 0 trait = envious }
			modifier = { factor = 2 trait = trusting }
			modifier = { factor = 1.1 FROM = { diplomacy = 9 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 10 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 11 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 12 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 13 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 14 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 15 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 16 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 17 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 18 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 19 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 20 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 21 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 22 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 23 } }
			modifier = { factor = 1.1 FROM = { diplomacy = 24 } }
			modifier = { factor = 2 is_lover = FROM }
			modifier = { factor = 2 dynasty = FROM }
			modifier = { factor = 1.5 is_close_relative = FROM }
		}

		add_character_modifier = {
			modifier = TOW_sent_troops_to_adventurer
			duration = 180
		}

		custom_tooltip = {
			text = TOW_TOG_1218_support_custom_tooltip
			hidden_tooltip = {
				FROM = {
					random_list = {
						3 = { change_variable = { which = "TOW_adventure_manpower" value = 6 } modifier = { factor = 0.5 martial = 12 } }
						4 = { change_variable = { which = "TOW_adventure_manpower" value = 7 } modifier = { factor = 0.5 martial = 15 } }
						5 = { change_variable = { which = "TOW_adventure_manpower" value = 8 } modifier = { factor = 0.5 martial = 18 } }
						4 = { change_variable = { which = "TOW_adventure_manpower" value = 9 } modifier = { factor = 0.5 martial = 21 } }
						2 = { change_variable = { which = "TOW_adventure_manpower" value = 10 } }
					}
					TOW_landless_claimant_adventurer_update_modifier = yes
					move_character = ROOT
					set_character_flag = TOW_adventure_helped_by_@ROOT
				}
			}
		}

		reverse_opinion = { modifier = TOW_opinion_helped_my_adventure who = FROM years = 10 }
	}

	option = { ## Don't care
		name = "EVTOPTC_TOG_1218"

		ai_chance = {
			factor = 20
			modifier = { factor = 1.5 trait = arbitrary }
			modifier = { factor = 1.5 FROM = { trait = ugly } }
			modifier = { factor = 0.75 FROM = { trait = fair } }
			modifier = { factor = 2 trait = slothful }
			modifier = { factor = 2 trait = paranoid }
			modifier = { factor = 20 trait = depressed }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -9 } } }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -19 } } }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -29 } } }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -39 } } }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -49 } } }
			modifier = { factor = 1.15 NOT = { opinion = { who = FROM value = -59 } } }
			modifier = { factor = 1.15 NOT = { opinion = { who = FROM value = -69 } } }
			modifier = { factor = 1.15 NOT = { opinion = { who = FROM value = -79 } } }
			modifier = { factor = 1.15 NOT = { opinion = { who = FROM value = -89 } } }
			modifier = { factor = 2.5 NOT = { opinion = { who = FROM value = -99 } } }
			modifier = { factor = 0.5 trait = kind }
			modifier = { factor = 0.5 trait = charitable }
		}

		reverse_opinion = { modifier = opinion_disappointed who = FROM years = 5 }
	}

	option = { ## Seize him !
		name = "EVTOPTD_TOG_1218"

		ai_chance = {
			factor = 10
			modifier = { factor = 3 trait = arbitrary }

			modifier = { factor = 10 trait = cruel }
			modifier = { factor = 2 trait = deceitful }
			modifier = { factor = 2 trait = impaler }
			modifier = { factor = 2 trait = wroth }
			modifier = { factor = 3 trait = lunatic }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -9 } } }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -19 } } }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -29 } } }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -39 } } }
			modifier = { factor = 1.1 NOT = { opinion = { who = FROM value = -49 } } }
			modifier = { factor = 1.15 NOT = { opinion = { who = FROM value = -59 } } }
			modifier = { factor = 1.15 NOT = { opinion = { who = FROM value = -69 } } }
			modifier = { factor = 1.15 NOT = { opinion = { who = FROM value = -79 } } }
			modifier = { factor = 1.15 NOT = { opinion = { who = FROM value = -89 } } }
			modifier = { factor = 3 NOT = { opinion = { who = FROM value = -99 } } }
			modifier = { factor = 0 opinion = { who = FROM value = 0 } }
			modifier = { factor = 0 trait = kind }
			modifier = { factor = 0 trait = charitable }
			modifier = {
				factor = 4
				trait = zealous
				FROM = { TOW_prev_dislikes_religion = yes }
			}
		}

		FROM = { imprison = ROOT }
		reverse_opinion = { modifier = TOW_opinion_prevented_me_from_adventuring who = FROM years = 25 }
	}

	after = {
		FROM = { clr_character_flag = TOW_adventure_asking_realm }
	}
}

### Adventurer and his band repels off bad modifiers
character_event = {
	id = TOG.1219

	hide_window = yes

	has_character_flag = TOW_preparing_adventure
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Old Gods"
		
		NOT = {
			has_game_rule = {
				name = adventurers
				value = none
			}
		}

		has_character_flag = TOW_preparing_adventure
		NOT = { has_character_flag = TOW_adventure_asking_realm }

		top_liege = {
			ROOT = { has_character_flag = TOW_adventure_helped_by_@PREV }
			any_realm_province = {
				OR = {
					has_province_modifier = thieves_guild
					has_province_modifier = smugglers_ring
					has_province_modifier = highway_robber_band
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 40
		modifier = { factor = 0.3 trait = just }
		modifier = { factor = 2 trait = arbitrary }
		modifier = { factor = 1.25 trait = craven }
		modifier = { factor = 0.9 trait = brave }
		modifier = { factor = 4 trait = slothful }
		modifier = { factor = 0.95 is_smart_trigger = yes }
		modifier = { factor = 0.9 trait = genius }
		modifier = { factor = 1.5 is_dumb_trigger = yes }
		modifier = { factor = 1.5 character_disease_trigger = yes }

		modifier = { factor = 0.95 check_variable = { which = "TOW_adventure_manpower" value = 40 } }
		modifier = { factor = 0.95 check_variable = { which = "TOW_adventure_manpower" value = 60 } }
		modifier = { factor = 0.95 check_variable = { which = "TOW_adventure_manpower" value = 80 } }
		modifier = { factor = 0.95 check_variable = { which = "TOW_adventure_manpower" value = 100 } }
		modifier = { factor = 0.95 check_variable = { which = "TOW_adventure_manpower" value = 120 } }

		modifier = { factor = 0.95 top_liege = { reverse_opinion = { who = ROOT value = 10 } } }
		modifier = { factor = 0.95 top_liege = { reverse_opinion = { who = ROOT value = 20 } } }
		modifier = { factor = 0.95 top_liege = { reverse_opinion = { who = ROOT value = 30 } } }
		modifier = { factor = 0.95 top_liege = { reverse_opinion = { who = ROOT value = 40 } } }
		modifier = { factor = 0.95 top_liege = { reverse_opinion = { who = ROOT value = 50 } } }
		modifier = { factor = 0.95 top_liege = { reverse_opinion = { who = ROOT value = 60 } } }
		modifier = { factor = 0.95 top_liege = { reverse_opinion = { who = ROOT value = 70 } } }
		modifier = { factor = 0.95 top_liege = { reverse_opinion = { who = ROOT value = 80 } } }
		modifier = { factor = 0.95 top_liege = { reverse_opinion = { who = ROOT value = 90 } } }
		modifier = { factor = 1.05 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -9 } } } }
		modifier = { factor = 1.05 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -19 } } } }
		modifier = { factor = 1.05 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -29 } } } }
		modifier = { factor = 1.05 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -39 } } } }
		modifier = { factor = 1.05 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -49 } } } }
		modifier = { factor = 1.05 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -59 } } } }
		modifier = { factor = 1.05 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -69 } } } }
		modifier = { factor = 1.05 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -79 } } } }
		modifier = { factor = 1.05 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -89 } } } }
	}
	
	immediate = {
		random_list = {
			20 = {}
			5 = { change_diplomacy = 1 }
			5 = { change_martial = 1 }
			5 = { change_martial = 2 }
			5 = { modifier = { factor = 0 NOT = { trait = craven } } remove_trait = craven }
		}
		top_liege = {
			random_realm_province = {
				limit = {
					OR = {
						has_province_modifier = thieves_guild
						has_province_modifier = smugglers_ring
						has_province_modifier = highway_robber_band
					}
				}
				random_list = {
					1 = {
						modifier = {
							factor = 0
							NOT = { has_province_modifier = thieves_guild }
						}
						remove_province_modifier = thieves_guild
						PREV = { add_character_flag = TOW_removed_thieves_guild }
						log = "-- TOW DEBUG -- : Adventure : [Root.GetBestName] repelled thieves_guild from the [This.County.GetFullName] for [Root.TopLiege.GetBestName]."
					}
					1 = {
						modifier = {
							factor = 0
							NOT = { has_province_modifier = smugglers_ring }
						}
						remove_province_modifier = smugglers_ring
						PREV = { add_character_flag = TOW_removed_smugglers_ring }
						log = "-- TOW DEBUG -- : Adventure : [Root.GetBestName] repelled smugglers_ring from the [This.County.GetFullName] for [Root.TopLiege.GetBestName]."
					}
					1 = {
						modifier = {
							factor = 0
							NOT = { has_province_modifier = highway_robber_band }
						}
						remove_province_modifier = highway_robber_band
						PREV = { add_character_flag = TOW_removed_highway_robber_band }
						log = "-- TOW DEBUG -- : Adventure : [Root.GetBestName] repelled highway_robber_band from the [This.County.GetFullName] for [Root.TopLiege.GetBestName]."
					}
				}
				county = { save_event_target_as = cleared_province }
			}
			character_event = {
				id = TOG.1220 # Notify the owner
			}
		}
	}
}

## Independent ruler notified that an adventurer repelled off bad men
character_event = {
	id = TOG.1220

	desc = {
		text = EVTDESC_TOG_1220_1
		trigger = { has_character_flag = TOW_removed_thieves_guild }
	}
	desc = {
		text = EVTDESC_TOG_1220_2
		trigger = { has_character_flag = TOW_removed_smugglers_ring }
	}
	desc = {
		text = EVTDESC_TOG_1220_3
		trigger = { has_character_flag = TOW_removed_highway_robber_band }
	}

	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	immediate = {
		clr_character_flag = TOW_removed_thieves_guild
		clr_character_flag = TOW_removed_smugglers_ring
		clr_character_flag = TOW_removed_highway_robber_band
	}
	
	option = { ## Great
		name = "EVTOPTA_TOG_1220"
		opinion = { modifier = opinion_grateful who = FROM }
	}

	option = { ## Reward the adventurer
		name = "EVTOPTB_TOG_1220"
		opinion = { modifier = opinion_grateful who = FROM }
		reverse_opinion = { modifier = TOW_opinion_was_rewarded who = FROM }
		transfer_scaled_wealth = { to = FROM value = 0.05 min = 5 max = 15 }
		hidden_tooltip = {
			FROM = {
				random_list = {
					3 = { change_variable = { which = "TOW_adventure_manpower" value = 2 } }
					4 = { change_variable = { which = "TOW_adventure_manpower" value = 3 } }
					3 = { change_variable = { which = "TOW_adventure_manpower" value = 4 } }
				}
			}
		}
		if = {
			limit = { trait = arbitrary }
			random = { chance = 60 remove_trait = arbitrary }
		}
		if = {
			limit = { NOT = { trait = just } NOT = { trait = arbitrary } }
			random = { chance = 20 add_trait = just }
		}
	}
}

### Adventurer's band plunders a province
character_event = {
	id = TOG.1221

	hide_window = yes

	has_character_flag = TOW_preparing_adventure
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Old Gods"
		
		NOT = {
			has_game_rule = {
				name = adventurers
				value = none
			}
		}

		has_character_flag = TOW_preparing_adventure
		NOT = { has_character_flag = TOW_adventure_asking_realm }
		check_variable = { which = "TOW_adventure_manpower" value = 30 }
		top_liege = {
			ROOT = { has_character_flag = TOW_adventure_helped_by_@PREV }
		}
	}
	
	mean_time_to_happen = {
		months = 50
		modifier = { factor = 2 trait = just }
		modifier = { factor = 0.5 trait = arbitrary }
		modifier = { factor = 0.4 trait = cruel }
		modifier = { factor = 0.9 trait = greedy }
		modifier = { factor = 0.9 trait = craven }
		modifier = { factor = 0.75 trait = wroth }
		modifier = { factor = 0.9 trait = deceitful }
		modifier = { factor = 0.9 trait = impaler }
		modifier = { factor = 1.5 trait = gregarious }
		modifier = { factor = 1.5 trait = kind }

		modifier = { factor = 0.95 check_variable = { which = "TOW_adventure_manpower" value = 80 } }

		modifier = { factor = 0.9 NOT = { diplomacy = 8 } }
		modifier = { factor = 0.9 NOT = { diplomacy = 7 } }
		modifier = { factor = 0.9 NOT = { diplomacy = 6 } }
		modifier = { factor = 0.9 NOT = { diplomacy = 5 } }
		modifier = { factor = 0.9 NOT = { diplomacy = 4 } }
		modifier = { factor = 0.9 NOT = { diplomacy = 3 } }
		modifier = { factor = 0.9 NOT = { diplomacy = 2 } }
		modifier = { factor = 0.9 NOT = { diplomacy = 1 } }

		modifier = { factor = 1.05 top_liege = { reverse_opinion = { who = ROOT value = 10 } } }
		modifier = { factor = 1.05 top_liege = { reverse_opinion = { who = ROOT value = 20 } } }
		modifier = { factor = 1.05 top_liege = { reverse_opinion = { who = ROOT value = 30 } } }
		modifier = { factor = 1.05 top_liege = { reverse_opinion = { who = ROOT value = 40 } } }
		modifier = { factor = 1.05 top_liege = { reverse_opinion = { who = ROOT value = 50 } } }
		modifier = { factor = 1.05 top_liege = { reverse_opinion = { who = ROOT value = 60 } } }
		modifier = { factor = 1.05 top_liege = { reverse_opinion = { who = ROOT value = 70 } } }
		modifier = { factor = 1.05 top_liege = { reverse_opinion = { who = ROOT value = 80 } } }
		modifier = { factor = 1.05 top_liege = { reverse_opinion = { who = ROOT value = 90 } } }
		modifier = { factor = 0.95 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -9 } } } }
		modifier = { factor = 0.95 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -19 } } } }
		modifier = { factor = 0.95 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -29 } } } }
		modifier = { factor = 0.95 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -39 } } } }
		modifier = { factor = 0.95 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -49 } } } }
		modifier = { factor = 0.95 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -59 } } } }
		modifier = { factor = 0.95 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -69 } } } }
		modifier = { factor = 0.95 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -79 } } } }
		modifier = { factor = 0.95 top_liege = { NOT = { reverse_opinion = { who = ROOT value = -89 } } } }
	}
	
	immediate = {

		random_list = {
			2 = { wealth = 10 }
			4 = { wealth = 15 }
			5 = { wealth = 20 }
			4 = { wealth = 25 }
			2 = { wealth = 30 }
		}
		random_list = {
			3 = { change_variable = { which = "TOW_adventure_manpower" value = 1 } }
			3 = { change_variable = { which = "TOW_adventure_manpower" value = 2 } }
			3 = { change_variable = { which = "TOW_adventure_manpower" value = 3 } }
		}
		top_liege = {
			random_realm_province = {
				log = "-- TOW DEBUG -- : Adventure : [Root.GetBestName] looted the [This.County.GetFullName] owned by [This.Holder.GetBestName] (Top Liege : [Root.TopLiege.GetBestName])."
				add_province_modifier = {
					name = TOW_looted_province
					years = 4
				}
				county = { save_event_target_as = looted_province }
				owner = {
					if = {
						limit = {
							NOT = { character = PREVPREV }
						}
						set_character_flag = TOW_adventurer_loot_victim
						character_event = {
							id = TOG.1222 # Notify the owner
						}
					}
				}
			}
			set_character_flag = TOW_adventurer_loot_liege
			character_event = {
				id = TOG.1222 # Notify the top liege
			}
		}
	}
}


## Independent ruler notified that an adventurer looted his lands
character_event = {
	id = TOG.1222

	desc = EVTDESC_TOG_1222

	picture = GFX_evt_burning_house
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = { ## What ?!
		trigger = {
			has_character_flag = TOW_adventurer_loot_victim
		}
		name = "EVTOPTA_TOG_1222"
		opinion = { modifier = opinion_furious who = FROM }
	}

	option = { ## Get them out ! NOW !
		trigger = {
			has_character_flag = TOW_adventurer_loot_liege
		}
		name = "EVTOPTB_TOG_1222"
		opinion = { modifier = opinion_furious who = FROM }
		if = {
			limit = { is_vassal_or_below = FROM }
			FROM = { banish = yes }
		}
	}


	after = {
		clr_character_flag = TOW_adventurer_loot_victim
		clr_character_flag = TOW_adventurer_loot_liege
	}
}
