namespace = holylightevents

#Priest has visions of Naaru
narrative_event = {
	id = holylightevents.1
	title = EVTTITLEHOLYLIGHT.1 # A Strange Vision
	desc = EVTDESCHOLYLIGHT.1 # While asleep, you are visited by the most strange images. Angelic beings composed of geometric forms that thrum with living light appear to you. Though you are not aware how, you know this Light to be pure and cleansing. Holy. When you awake, you feel that it was more than a dream. It was a vision. Humans need not appease the fickle spirits of nature, you realise, not when they could be standing in the Light.
	picture = "GFX_evt_naaru"
	border = "GFX_event_narrative_frame_religion"
	
	min_age = 16
	only_capable = yes
	prisoner = no
	religion = old_ways
	
	mean_time_to_happen = {
		years = 700
		modifier = {
			factor = 0.75
			is_title_active = k_lordaeron
			OR = {
				ROOT = { has_landed_title = k_lordaeron }
				ROOT = {
					top_liege = {
						trait = human
						has_landed_title = k_lordaeron
					}
				}
			}
		}
		modifier = {
			factor = 0.75
			is_title_active = k_stormwind
			OR = {
				ROOT = { has_landed_title = k_stormwind }
				ROOT = {
					top_liege = {
						trait = human
						has_landed_title = k_stormwind
					}
				}
			}
		}
		modifier = {
			factor = 0.75
			is_priest = yes
		}
		modifier = {
			factor = 0.5
			NOT = { religion_authority = 0.5 }
		}
		modifier = {
			factor = 1.5
			has_game_rule = {
				name = troll_wars_events
				value = alternate
			}
		}
	}
	
	trigger = {
		trait = healer
		NOR = {
			has_landed_title = d_tyrs_guard
			any_liege = {
				has_landed_title = d_tyrs_guard
			}
		}
		NOR = {
			has_global_flag = human_shamanism
			has_global_flag = holy_light_founded
			trait = lunatic
			trait = cynical
			has_character_flag = naaru_visions
			government = kirin_tor_government
			any_liege = {
				government = kirin_tor_government
			}
			has_character_flag = has_adv_class
		}
		trait = human
		religion = old_ways
		has_global_flag = trollwars_bookmark
		has_global_flag = trollwar_end
		OR = {
			is_title_active = k_lordaeron
			is_title_active = k_stormwind
			any_playable_ruler = {
				trait = human
				OR = {
					real_tier = KING
					real_tier = EMPEROR
				}
			}
		}
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.1.a # We must embrace this Holy Light!
		ai_chance = {
			factor = 20
		}
		piety = 200
		prestige = 100
		random = {
			chance = 75
			add_trait = zealous
		}
		set_global_flag = holy_light_founded
		religion = holy_light
		remove_trait = healer
		add_trait = priest
		set_character_flag = naaru_visions
		ROOT = {
			top_liege = {
				if = {
					limit = {
						trait = human
						religion = old_ways
						NOR = { 
							has_character_flag = conversion_chance_holy_light
							trait = zealous
						}
					}
					character_event = { id = holylightevents.2 }
				}
				any_realm_character = {
					if = {
						limit = {
							trait = human
							religion = old_ways
							NOR = { 
								has_character_flag = conversion_chance_holy_light
								trait = zealous
							}
						}
						character_event = { id = holylightevents.2 }
					}
				}
			}
		}
		abdicate = yes
		k_archbishop_state = { grant_title = ROOT }
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.1.b # A dream, nothing more.
		ai_chance = {
			factor = 1
			modifier = {
				factor = 10
				has_game_rule = {
					name = troll_wars_events
					value = alternate
				}
			}
		}
		random = {
			chance = 50
			remove_trait = zealous
			add_trait = cynical
		}
		set_character_flag = naaru_visions
	}
}

#Character is asked to convert to holy light. If landed, all courtiers and vassals get this event.
character_event = {
	id = holylightevents.2
	desc = EVTDESCHOLYLIGHT.2 # You've been recently told by [From.GetBestName] of a force known only as the Holy Light. It seems to be far more powerful, benevolent and constant than the nature spirits you are used to beseeching. Perhaps you should embrace it like [From.GetSheHe] did.
	picture = "GFX_evt_anduin"
	border = "GFX_event_normal_frame_religion"
	
	min_age = 16
	only_capable = yes
	prisoner = no
	religion = old_ways
	
	is_triggered_only = yes
	
	trigger = {
		NOR = {
			has_landed_title = d_tyrs_guard
			any_liege = {
				has_landed_title = d_tyrs_guard
			}
		}
		has_global_flag = holy_light_founded
		trait = human
		NOR = {
			trait = zealous
			has_character_flag = conversion_chance_holy_light
		}
	}
	
	immediate = {
		set_character_flag = conversion_chance_holy_light
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.2.a # Yes, praise this... Light.
		ai_chance = {
			factor = 10
		}
		religion = holy_light
		if = {
			limit = {
				is_ruler = yes
			}
			any_realm_character = {
				if = {
					limit = {
						trait = human
						religion = old_ways
						NOR = { 
							has_character_flag = conversion_chance_holy_light
							trait = zealous
						}
					}
					character_event = { id = holylightevents.2 }
				}
			}
		}
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.2.b # Such nonsense.
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				has_game_rule = {
					name = troll_wars_events
					value = alternate
				}
			}
		}
		piety = 10
	}
}

#Human in a non-light realm hears about religion and is given a chance to convert.
character_event = {
	id = holylightevents.3
	desc = EVTDESCHOLYLIGHT.3 # You've been hearing of a new faith in other human realms, where instead of animal spirits, priests beseech a radiant power known as the Holy Light. Moreover, it certainly does seem to answer prayers. Mayhaps you should convert too?
	picture = "GFX_evt_anduin"
	border = "GFX_event_normal_frame_religion"
	
	min_age = 16
	only_capable = yes
	prisoner = no
	religion = old_ways
	
	mean_time_to_happen = {
		years = 10
		modifier = {
			factor = 1.5
			has_game_rule = {
				name = troll_wars_events
				value = alternate
			}
		}
	}
	
	trigger = {
		NOR = {
			has_landed_title = d_tyrs_guard
			any_liege = {
				has_landed_title = d_tyrs_guard
			}
		}
		has_global_flag = holy_light_founded
		NOR = {
			trait = zealous
			has_character_flag = conversion_chance_holy_light
			any_liege = {
				religion = holy_light
			}
		}
		religion = old_ways
		trait = human
	}
	
	immediate = {
		set_character_flag = conversion_chance_holy_light
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.2.a # Yes, praise this... Light.
		ai_chance = {
			factor = 10
		}
		religion = holy_light
		if = {
			limit = {
				is_ruler = yes
			}
			any_realm_character = {
				if = {
					limit = {
						trait = human
						religion = old_ways
						NOR = { 
							has_character_flag = conversion_chance_holy_light
							trait = zealous
						}
					}
					character_event = { id = holylightevents.2 }
				}
			}
		}
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.2.b # Such nonsense.
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				has_game_rule = {
					name = troll_wars_events
					value = alternate
				}
			}
		}
		piety = 10
	}
}

#Human animist province randomly converts to the Holy Light.
province_event = {
	id = holylightevents.4
	desc = EVTDESCHOLYLIGHT.4 # The population in [Root..GetName] has mostly converted to the faith of the Holy Light.
	picture = "GFX_evt_anduin"
	border = "GFX_event_normal_frame_religion"
	
	mean_time_to_happen = { 
		months = 40
		modifier = {
			factor = 1.5
			has_game_rule = {
				name = troll_wars_events
				value = alternate
			}
		}
	}
	
	trigger = {
		has_global_flag = holy_light_founded
		ROOT = {
			culture_group = human
			religion = old_ways
		}
	}
	
	immediate = {
		religion = holy_light
	}
	
	option = {
		name = {
			text = EVTOPTHOLYLIGHT.4.a # Praise the Light!
			trigger = {
				ROOT = {
					owner = {
						religion = holy_light
					}
				}
			}
		}
		name = {
			text = EVTOPTHOLYLIGHT.4.b # Interesting.
			trigger = {
				ROOT = {
					owner = {
						NOT = { religion = holy_light }
					}
				}
			}
		}
	}
}

#Dwarf in a non-light realm hears about religion and is given a chance to convert.
character_event = {
	id = holylightevents.5
	desc = EVTDESCHOLYLIGHT.5 # You've been hearing of a new faith in the human realms, where instead of animal spirits, priests beseech a radiant power known as the Holy Light. Moreover, it certainly does seem to answer prayers. Mayhaps you should convert too?
	picture = "GFX_evt_anduin"
	border = "GFX_event_normal_frame_religion"
	
	min_age = 16
	only_capable = yes
	prisoner = no
	religion = geomancy
	
	mean_time_to_happen = {
		years = 10
		modifier = {
			factor = 1.5
			has_game_rule = {
				name = troll_wars_events
				value = alternate
			}			
		}
	}
	
	trigger = {
		has_global_flag = holy_light_founded
		NOR = {
			trait = zealous
			has_character_flag = conversion_chance_holy_light
			religion = holy_light
			any_liege = {
				religion = holy_light
			}
		}
		trait = AK_trait_dwarf
		culture = bronzebeard
	}
	
	immediate = {
		set_character_flag = conversion_chance_holy_light
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.2.a # Yes, praise this... Light.
		ai_chance = {
			factor = 10
		}
		religion = holy_light
		if = {
			limit = {
				is_ruler = yes
			}
			any_realm_character = {
				if = {
					limit = {
						trait = AK_trait_dwarf
						culture = bronzebeard
						NOR = { 
							has_character_flag = conversion_chance_holy_light
							trait = zealous
							religion = holy_light
						}
					}
					character_event = { id = holylightevents.6 }
				}
			}
		}
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.2.b # Such nonsense.
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				has_game_rule = {
					name = troll_wars_events
					value = alternate
				}
			}
		}
		piety = 10
	}
}

#Dwarf is asked to convert to holy light. If landed, all courtiers and vassals get this event.
character_event = {
	id = holylightevents.6
	desc = EVTDESCHOLYLIGHT.6 # You've been recently told by [From.GetBestName] of a force known only as the Holy Light. It seems to be far more powerful, benevolent and constant than the nature spirits you are used to beseeching. Perhaps you should embrace it like [From.GetSheHe] did.
	picture = "GFX_evt_anduin"
	border = "GFX_event_normal_frame_religion"
	
	min_age = 16
	only_capable = yes
	prisoner = no
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = holy_light_founded
		NOR = {
			trait = zealous
			has_character_flag = conversion_chance_holy_light
			religion = holy_light
		}
		trait = AK_trait_dwarf
		culture = bronzebeard
	}
	
	immediate = {
		set_character_flag = conversion_chance_holy_light
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.2.a # Yes, praise this... Light.
		ai_chance = {
			factor = 10
		}
		religion = holy_light
		if = {
			limit = {
				is_ruler = yes
			}
			any_realm_character = {
				if = {
					limit = {
						trait = AK_trait_dwarf
						culture = bronzebeard
						NOR = { 
							has_character_flag = conversion_chance_holy_light
							trait = zealous
							religion = holy_light
						}
					}
					character_event = { id = holylightevents.6 }
				}
			}
		}
	}
	
	option = {
		name = EVTOPTHOLYLIGHT.2.b # Such nonsense.
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				has_game_rule = {
					name = troll_wars_events
					value = alternate
				}
			}
		}
		piety = 10
	}
}