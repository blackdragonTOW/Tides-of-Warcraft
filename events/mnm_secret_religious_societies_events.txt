###########################################
#                                         #
# M&M Secret religious cults              #
#                                         #
# ID MNM.3000-MNM.3999		              #
#                                         #
###########################################

#IDs:
#3100-3199 David
#3200-3399 Milla
#3400-3599 Mathilda
#3600-3799 Drikus
#3800-3948 Joel
#3949-3997 Jakob

#Useful triggers
#is_secret_religious_society_member_trigger
#is_christian_secret_religious_society_member_trigger
#is_muslim_secret_religious_society_member_trigger
#is_indian_secret_religious_society_member_trigger
#is_openly_of_prevs_secret_religion_trigger
#has_sympathy_for_true_religion_of_prev_trigger
#true_religion_X_trigger
#true_religion_group_X_trigger
#is_in_prevs_interesting_society_trigger
#shares_prevs_secret_religion_trigger

#Useful effects 
#add_trait_for_prevs_secret_religion_society_effect 
#add_prevs_secret_religion_trait_effect 
#add_sympathy_for_prevs_true_religion_effect


namespace = MNM


#JOINING

#Sat in house of worship, approached by someone sat next to me
character_event = {
    id = MNM.3420
    desc = EVTDESC_MNM_3420
    picture = GFX_evt_bishop
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes 

    hide_from = yes
    
    immediate = {
    	#The inductor
    	if = {
    		limit = { NOT = { event_target:secret_religion_recruiter = { always = yes } } }
    		random_society_member = { #backup
    			limit = { 
    				is_in_prevs_interesting_society_trigger = yes 
    				ai = yes
    			}
    			save_event_target_as = secret_religion_recruiter 
    		}
    		random_society_member = { #diplo range
    			limit = { 
    				is_in_prevs_interesting_society_trigger = yes 
    				is_within_diplo_range = ROOT
    				ai = yes
    			}
    			save_event_target_as = secret_religion_recruiter 
    		}
    		random_society_member = { #same realm
    			limit = { 
    				is_in_prevs_interesting_society_trigger = yes 
    				same_realm = ROOT
    				ai = yes
    			}
    			save_event_target_as = secret_religion_recruiter 
    		}
    		any_courtier = { #a courtier
    			limit = { 
    				is_in_prevs_interesting_society_trigger = yes 
    				ai = yes
    			}
    			save_event_target_as = secret_religion_recruiter 
    		}
    	}
    	save_event_target_as = secret_religion_recruitee
    	#For loc 
    	random_realm_character = {
    		limit = { is_female = no }
    		save_event_target_as = spiritual_gender
    	}
    	random_courtier_or_vassal = {
    		limit = { is_priest = yes }
    		save_event_target_as = spiritual_gender
    	}
    }

    #Follow them
    option = { 
        name = EVTOPTA_MNM_3420
        custom_tooltip = { text = EVTOPTA_MNM_3420_TT }

        hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3425 days = 3 } } }

        ai_chance = {
        	factor = 2
        	modifier = {
        		factor = 10
        		trait = brave 
        	}
        	modifier = {
        		factor = 5
        		trait = just 
        	}
        	modifier = {
        		factor = 5
        		trait = trusting 
        	}
        }
    }

    #Remain seated
    option = {
        name = EVTOPTB_MNM_3420
        custom_tooltip = { text = EVTOPTB_MNM_3420_TT }

        hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3423 days = 1 } } } #notification of failure
        #set_interested_society = none

        ai_chance = {
        	factor = 3
        	modifier = {
        		trait = craven
        		factor = 15
        	}
        	modifier = {
        		trait = paranoid
        		factor = 5
        	}
        	modifier = {
        		trait = arbitrary
        		factor = 5
        	}
        	modifier = {
        		trait = content
        		factor = 5
        	}		
        }
    }
}

#Ping event
character_event = {
    id = MNM.3425
    hide_window = yes

    is_triggered_only = yes
    
    option = { 
        event_target:secret_religion_recruitee = { character_event = { id = MNM.3421 } }
    }
}

#Came with them, they offered me to join
character_event = {
    id = MNM.3421
    picture = GFX_evt_shady_meeting
    border = GFX_event_normal_frame_religion

    desc = {
    	trigger = { event_target:secret_religion_recruiter = { ROOT = { character_knows_prev_trigger = yes } } }
    	text = EVTDESC_MNM_3421_A
    }
     desc = {
    	trigger = { event_target:secret_religion_recruiter = { ROOT = { character_knows_prev_trigger = no } } }
    	text = EVTDESC_MNM_3421_B
    }

    is_triggered_only = yes

    immediate = {
    	event_target:secret_religion_recruiter = { save_event_target_as = secret_religion_recruiter }
    }

    #Yes
    option = { 
        name = EVTOPTA_MNM_3421
        custom_tooltip = { text = EVTOPTA_MNM_3421_TT }
        hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3422 days = 1 } } }
        ai_chance = { 
            factor = 4 
            modifier = { is_in_society = yes factor = 0 } #Cannot join a new society when they're already in a society
        }
    }

    #No
    option = {
        name = EVTOPTB_MNM_3421
        custom_tooltip = { text = EVTOPTB_MNM_3421_TT }

        hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3423 days = 1 } } } #notification of failure
        #set_interested_society = none

        ai_chance = { factor = 5 }
    }
}

#The interested party accepted
character_event = {
    id = MNM.3422
    desc = EVTDESC_MNM_3422
    picture = GFX_evt_shady_meeting
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
	immediate = {
		society = { save_event_target_as = recruiter_society }
	}
	
    option = { 
        name = EVTOPTA_MNM_3422
        
        tooltip = { event_target:secret_religion_recruitee = { join_society = event_target:recruiter_society } }

        hidden_effect = { event_target:secret_religion_recruitee = { character_event = { id = MNM.3424 days = 2 } } }
    }
}

#The interested party rejected
character_event = {
    id = MNM.3423
    desc = EVTDESC_MNM_3423
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3423
    }
}

#Confirmation for joiner on joining
character_event = {
    id = MNM.3424
    desc = EVTDESC_MNM_3424
    picture = GFX_evt_religious_exultation
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3424

        join_society = event_target:recruiter_society
    }
}

#POWER: Induct character to secret faith
character_event = {
    id = MNM.3408
    desc = EVTDESC_MNM_3408
    picture = GFX_evt_library
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    immediate = {
    	save_event_target_as = secret_religion_inductor
    	FROM = { save_event_target_as = secret_religion_inductee }
    }
    
    #A passage about great warriors of the faith
    option = { 
        name = EVTOPTA_MNM_3408
        custom_tooltip = { text = EVTOPTA_MNM_3408_TT }
        set_character_flag = induction_argument_war
    }

    #A passage about community  
    option = {
        name = EVTOPTB_MNM_3408
        custom_tooltip = { text = EVTOPTB_MNM_3408_TT }
         set_character_flag = induction_argument_community
    }
    
    #An interesting passage on matters of ethics and philosophy
    option = {
        name = EVTOPTC_MNM_3408
        custom_tooltip = { text = EVTOPTC_MNM_3408_TT }
         set_character_flag = induction_argument_theology
    }
    
    #A passage about a succesful and fair ruler
    option = {
        name = EVTOPTD_MNM_3408
        custom_tooltip = { text = EVTOPTD_MNM_3408_TT }
        set_character_flag = induction_argument_stewardship
    }

    after = {
    	hidden_effect = { event_target:secret_religion_inductee = { character_event = { id = MNM.3409 days = 3 } } }
    }
}

#Finds a holy book
character_event = {
    id = MNM.3409
    picture = GFX_evt_library
    desc = EVTDESC_MNM_3409
    border = GFX_event_normal_frame_religion

    hide_from = yes

    is_triggered_only = yes
  
    #Read it
    option = { 
        name = EVTOPTA_MNM_3409
        custom_tooltip = { text = EVTOPTA_MNM_3409_TT }

        hidden_effect = { character_event = { id = MNM.3410 days = 12 } }
        ai_chance = { factor = 10 }
    }

    #Hide it
    option = {
        name = EVTOPTC_MNM_3409
        custom_tooltip = { text = EVTOPTC_MNM_3409_TT }

        hidden_effect = { event_target:secret_religion_inductor = { character_event = { id = MNM.3413 days = 3 } } } #fail event

        random = {
        	chance = 10
        	add_trait_paranoid_effect = yes
        }

        ai_chance = { factor = 0 }
    }
}

#Reading the holy book
character_event = {
    id = MNM.3410
    picture = GFX_evt_secluded_in_prayer
    border = GFX_event_normal_frame_religion

    desc = {
    	trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_war } }
    	text = EVTDESC_MNM_3410_A
    }
    desc = {
    	trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_community } }
    	text = EVTDESC_MNM_3410_B
    }
    desc = {
    	trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_theology } }
    	text = EVTDESC_MNM_3410_C
    }
    desc = {
    	trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_stewardship } }
    	text = EVTDESC_MNM_3410_D
    }

    hide_from = yes

    is_triggered_only = yes

    #It speaks the truth
    option = { 
        name = EVTOPTA_MNM_3410
        #custom_tooltip = { text = EVTOPTA_MNM_3410_TT }

        hidden_effect = {
	        clear_secret_religion = yes
	    }
	    #Add new secret religion
		set_secret_religion = event_target:secret_religion_inductor
       	event_target:secret_religion_inductor = {
       		#And update the inductor
       		hidden_effect = { character_event = { id = MNM.3411 days = 3 } }
       	}

       	ai_chance = {
        	factor = 60
        	modifier = { trait = trusting factor = 2 }
        	modifier = { controls_religion = yes factor = 0 }
        	modifier = { FROM = { diplomacy = 12 } factor = 1.4 }
        	modifier = { FROM = { diplomacy = 14 } factor = 1.4 }
        	modifier = { FROM = { diplomacy = 16 } factor = 1.3 }
            modifier = { FROM = { diplomacy = 18 } factor = 1.3 }
            modifier = { FROM = { diplomacy = 20 } factor = 1.2 }
            modifier = { FROM = { diplomacy = 22 } factor = 1.2 }
        	modifier = { FROM = { ai = yes } factor = 1.5 } #The AI makes an uniformed choice, so they need this boost

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = induction_argument_war }
        		OR = {
        			trait = brave
        			has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
					has_job_title = job_marshal
        		}
        	}

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = induction_argument_community }
        		OR = {
        			trait = gregarious
        			num_of_friends = 1
        			num_of_lovers = 1
        			any_child = { reverse_opinion = { who = ROOT value = 35 } }
        			has_education_diplomacy_trigger = yes
        			has_lifestyle_diplomacy_trigger = yes
        		}
        	}

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = induction_argument_theology }
        		OR = {
        			trait = erudite
        			has_education_learning_trigger = yes
        			has_lifestyle_learning_trigger = yes
        		}
        	}

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = induction_argument_stewardship }
        		OR = {
        			trait = ambitious
        			trait = just
        			has_lifestyle_stewardship_trigger = yes
        			has_education_stewardship_trigger = yes
        		}
        	}
        }
    }

    #Reaffirmed my belief
    option = {
        name = EVTOPTB_MNM_3410

        piety = 100

       	hidden_effect = { event_target:secret_religion_inductor = { character_event = { id = MNM.3413 days = 3 } } } #fail event

        ai_chance = {
        	factor = 40
        	modifier = { is_priest = yes factor = 2 }
        	modifier = { trait = paranoid factor = 2 }
			modifier = { trait = zealous factor = 6 }
        	modifier = { NOT = { FROM = { diplomacy = 8 } } factor = 2 }
        	modifier = { tier = BARON factor = 2 }
			modifier = { tier = COUNT factor = 3 }
        	modifier = { tier = DUKE factor = 4 }
        	modifier = { tier = KING is_nomadic = no factor = 16 }
        	modifier = { tier = EMPEROR is_nomadic = no factor = 32 }
        }
    }

    after = {
    	hidden_effect = {
    		event_target:secret_religion_inductor = {
    			clr_character_flag = induction_argument_war
    			clr_character_flag = induction_argument_community
    			clr_character_flag = induction_argument_theology
    			clr_character_flag = induction_argument_stewardship
    		}
    	}
    }
}

#The inductee did accept my secret religion
character_event = {
    id = MNM.3411
    desc = EVTDESC_MNM_3411
    picture = GFX_evt_secluded_in_prayer
    border = GFX_event_normal_frame_religion

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    #Attempt to recruit them
    option = { 
        name = EVTOPTA_MNM_3411
        custom_tooltip = { text = EVTOPTA_MNM_3411_TT }

        #Recruitment
        hidden_effect = {
        	save_event_target_as = secret_religion_recruiter
        	event_target:secret_religion_inductee = { 
        		character_event = { id = MNM.3420 days = 14 }
        		add_character_modifier = {
					name = secret_religions_recruitment_timer
					years = 5
					hidden = yes
				}
        	}
        }        

        ai_chance = {
        	factor = 5
        	modifier = { event_target:secret_religion_inductee = { is_ruler = yes } factor = 20 }
        	modifier = { event_target:secret_religion_inductee = { diplomacy = 12 } factor = 5 }
        	modifier = { event_target:secret_religion_inductee = { diplomacy = 15 } factor = 4 }
            modifier = {
                factor = 0 # don't recruit characters interested in something else
                event_target:secret_religion_inductee = { ai = no }
                event_target:secret_religion_inductee = { NOT = { interested_in_society = secret_religious_cult } }
                event_target:secret_religion_inductee = { is_interested_in_any_society = yes }
            }
        }
    }

    #Good
    option = { 
        name = EVTOPTB_MNM_3411

        ai_chance = { factor = 10 }
    }

    after = {
    	event_target:secret_religion_inductee = {
    		tooltip = { set_secret_religion = event_target:secret_religion_inductor }
    		if = {
    			limit = { 
	        		ROOT = { has_quest = quest_secret_religious_societies_induct_ruler }
	        		is_quest_target_of = ROOT
	        	}
	        	ROOT = { 
                    clr_quest = quest_secret_religious_societies_induct_ruler 
                    add_society_currency_major_effect = yes
                }
    		}
    	}
    }
}


#Fail: Inductee hid/didn't read book
character_event = {
    id = MNM.3413
    desc = EVTDESC_MNM_3413
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_religion

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3412

        if = {
        	limit = { 
        		has_quest = quest_secret_religious_societies_induct_ruler 
        		FROM = { is_quest_target_of = ROOT }
        	}
        	clr_quest = { id = quest_secret_religious_societies_induct_ruler failure = yes }
        }
    }
}

# openly_adopt_faith - Convert cultists
character_event = {
	id = MNM.3800
	desc = EVTDESC_MNM_3800
    picture = GFX_evt_society_joining
    border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = currently_part_of_secret_religion_uncovering
	}
	
	option = {
		name = EVTOPTA_MNM_3800
		if = {
			limit = {
				any_demesne_title = {
					controls_religion = yes
				}
			}
			hidden_tooltip = {
				liege = {
					save_event_target_as = liege_target
				}
				create_character = {
					age = 38
					dynasty = random
					religion = ROOT
					culture = ROOT
					random_traits = yes
				}
				new_character = {
					save_event_target_as = new_holder
				}
			}
			any_demesne_title = {
				limit = {
					controls_religion = yes
				}
				grant_title = event_target:new_holder
				holder_scope = {
					any_vassal = {
						set_defacto_liege = event_target:liege_target
					}
				}
			}
			hidden_tooltip = {
				set_defacto_liege = event_target:liege_target
			}
		}
		if = { # Holy Orders/Static Mercs are given to a random new character
			limit = {
				any_demesne_title = {
					OR = {
						holy_order = yes
						mercenary = yes
					}
				}
			}
			hidden_tooltip = {
				liege = {
					save_event_target_as = liege_target
				}
				create_character = {
					age = 38
					dynasty = random
					religion = ROOT
					culture = ROOT
					random_traits = yes
				}
				new_character = {
					save_event_target_as = new_holder
				}
			}
			any_demesne_title = {
				limit = {
					OR = {
						holy_order = yes
						mercenary = yes
					}
				}
				grant_title = event_target:new_holder
				holder_scope = {
					any_vassal = {
						set_defacto_liege = event_target:liege_target
					}
				}
			}
			hidden_tooltip = {
				set_defacto_liege = event_target:liege_target
			}
		}
		flip_to_secret_religion_effect = yes
		leave_society = yes
        if = {
            limit = { ai = yes }
            set_character_flag = ai_flag_refuse_conversion
        }
	}
}

###INTERACTIONS###

#Interaction: I am so stressed
character_event = {
    id = MNM.3500
    hide_window = yes
    is_triggered_only = yes

    min_age = 16
    only_playable = yes
    only_capable = yes
    prisoner = no
   
    trigger = {
        OR = {
            trait = stressed
            trait = depressed
        }
        society_member_of = tyrs_guard_society

        society = {
            any_society_member = {
                ai = yes
                block_general_event_trigger = no
                opinion = { who = ROOT value = 20 }
                reverse_opinion = { who = ROOT value = 20 }
                NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
                NOT = { is_lover = ROOT }
                OR = {
                    is_friend = ROOT 
                    AND = {
                        root_attraction_trigger = yes
                        NOT = { is_close_relative = ROOT }
                    }
                }
            }
        }
    }

    immediate = {
        society = {
            random_society_member = {
                limit = {
                    ai = yes
                    block_general_event_trigger = no
                    opinion = { who = ROOT value = 20 }
                    reverse_opinion = { who = ROOT value = 20 }
                    NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
                    NOT = { is_lover = ROOT }
                    OR = {
                        is_friend = ROOT 
                        AND = {
                            root_attraction_trigger = yes
                            NOT = { is_close_relative = ROOT }
                        }
                    }
                    is_within_diplo_range = ROOT
                }
                save_event_target_as = supportive_sr_member
            }
            random_society_member = {
                limit = {
                    ai = yes
                    block_general_event_trigger = no
                    opinion = { who = ROOT value = 20 }
                    reverse_opinion = { who = ROOT value = 20 }
                    NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
                    NOT = { is_lover = ROOT }
                    OR = {
                        is_friend = ROOT 
                        AND = {
                            root_attraction_trigger = yes
                            NOT = { is_close_relative = ROOT }
                        }
                    }
                    same_realm = ROOT
                }
                save_event_target_as = supportive_sr_member
            }
            random_society_member = {
                limit = {
                    ai = yes
                    block_general_event_trigger = no
                    opinion = { who = ROOT value = 20 }
                    reverse_opinion = { who = ROOT value = 20 }
                    NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
                    NOT = { is_lover = ROOT }
                    OR = {
                        is_friend = ROOT 
                        AND = {
                            root_attraction_trigger = yes
                            NOT = { is_close_relative = ROOT }
                        }
                    }
                    at_location = ROOT
                }
                save_event_target_as = supportive_sr_member
            }
        }
        event_target:supportive_sr_member = { character_event = { id = MNM.3501 } }
    }
}


character_event = {
    id = MNM.3501
    hide_window = yes
    is_triggered_only = yes
    immediate = { FROM = { character_event = { id = MNM.3502 } } }
}   

#I am stessed, do I find support?
character_event = {
    id = MNM.3502
    desc = EVTDESC_MNM_3502
    picture = GFX_evt_secret_ceremony
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    #Friend
    option = { 
        trigger = { NOT = { is_friend = FROM } }
        name = EVTOPTA_MNM_3502
        add_friend = FROM

        ai_chance = { factor = 100 }
    }

    #Lover?
    option = {
        trigger = {
            FROM = { root_attraction_trigger = yes }
            NOT = { is_close_relative = FROM }
        }
        name = EVTOPTB_MNM_3502
        custom_tooltip = { text = EVTOPTB_MNM_3502_TT }

        hidden_effect = { FROM = { character_event = { id = MNM.6906 days = 3 } } }

        ai_chance = {
            factor = 10
            modifier = {
                factor = 10
                OR = {
                    trait = lustful
                    trait = seducer
                    trait = seductress
                    trait = gregarious
                    trait = socializer
                }
            }
            modifier = {
                factor = 5
                FROM = { has_attractive_trait_trigger = yes }
            }
        }
    }
    
    #Not lover
    option = {
        trigger = {
            FROM = { root_attraction_trigger = yes }
            NOT = { is_close_relative = FROM }
            is_friend = FROM
        }

        name = EVTOPTA_MNM_3502
        custom_tooltip = { text = EVTOPTC_MNM_3502_TT }

        ai_chance = { factor = 100 }
    }
    
    after = {
        if = {
            limit = { trait = stressed }
            remove_trait = stressed
        }
        if = {
            limit = { trait = depressed }
            remove_trait = depressed
        }
        if = {
            limit = { FROM = { trait = stressed } }
            remove_trait = stressed
        }
        if = {
            limit = { FROM = { trait = depressed } }
            remove_trait = depressed
        }
    }
}

#Love ping event
character_event = {
    id = MNM.6906
    hide_window = yes
    is_triggered_only = yes
    immediate = { 

        random_list = {
            50 = { #Not interested
                modifier = { is_married = yes factor = 2 }
                modifier = { any_lover = { is_alive = yes } factor = 4 }
                modifier = { trait = chaste factor = 4 }
                modifier = { trait = celibate factor = 10 }
                modifier = { has_unpleasant_trait_trigger = yes factor = 2 }
                modifier = { NOT = { opinion = { who = FROM value = 20 } } factor = 2 }
                modifier = { 
                    root_attraction_trigger = no 
                    NOT = { trait = homosexual }
                    factor = 0.5 
                }
                modifier = { 
                    root_attraction_trigger = no 
                    trait = homosexual
                    factor = 0
                }
                set_character_flag = not_interested
            } 
            50 = { #Interested
                modifier = { trait = lustful factor = 4 }
                modifier = { has_pleasant_trait_trigger = yes factor = 2 }
                modifier = { opinion = { who = FROM value = 40 } factor = 2 }
                modifier = { FROM = { has_attractive_trait_trigger = yes } factor = 3 }

                set_character_flag = interested

                if = {
                    limit = { same_sex = FROM }
                    add_trait = homosexual 
                }
            }
        }

        FROM = { character_event = { id = MNM.6907 } }
    }
}

#Interaction: Get help from another member with problematic trait
character_event = {
    id =  MNM.3505
    hide_window = yes

    is_triggered_only = yes

    min_age = 16
    only_playable = yes
    only_capable = yes
    prisoner = no

    trigger = {
        society_member_of = secret_religious_cult
        check_variable = { which = visibility_value value = 1 }
        block_general_event_trigger = no
        OR = {
            trait = honest
            trait = slothful
            trait = wroth
            trait = trusting
            NOT = { intrigue = 8 }
        }
    }

    immediate = {
        clr_character_flag = sr_too_honest
        clr_character_flag = sr_too_wroth
        clr_character_flag = sr_too_slothful
        clr_character_flag = sr_too_trusting
        clr_character_flag = sr_too_indiscreet

        random_list = {
            20 = { #Root is too honest
                modifier = {
                    factor = 0
                    NAND = {
                        trait = honest
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                NOT = { trait = honest }  
                            }
                        }
                    }
                }
                set_character_flag = sr_too_honest

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            NOT = { trait = honest }  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
            20 = { #Root is too slothful
                modifier = {
                    factor = 0
                    NAND = {
                        trait = slothful
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                NOT = { trait = slothful }  
                            }
                        }
                    }
                }
                set_character_flag = sr_too_slothful

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            NOT = { trait = slothful }  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
            20 = { #Root is too wroth
                modifier = {
                    factor = 0
                    NAND = {
                        trait = wroth
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                NOT = { trait = wroth }  
                            }
                        }
                    }
                }
                set_character_flag = sr_too_wroth

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            NOT = { trait = wroth }  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
            20 = { #Root is too trusting
                modifier = {
                    factor = 0
                    NAND = {
                        trait = trusting
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                NOT = { trait = trusting }  
                            }
                        }
                    }
                }
                set_character_flag = sr_too_trusting

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            NOT = { trait = trusting }  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
            20 = { #Root is too indiscreet
                modifier = {
                    factor = 0
                    NAND = {
                        intrigue = 8
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                intrigue = 12
                            }
                        }
                    }
                }
                set_character_flag = sr_too_indiscreet

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            intrigue = 12  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
        }
    }
}

#This person is too suspicious, what do?
character_event = {
    id = MNM.3506
    picture = GFX_evt_catching_heretic
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    desc = {
        trigger = { FROM = { has_character_flag = sr_too_honest } }
        text = EVTDESC_MNM_3506_A
    }
    desc = {
        trigger = { FROM = { has_character_flag = sr_too_wroth } }
        text = EVTDESC_MNM_3506_B
    }
    desc = {
        trigger = { FROM = { has_character_flag = sr_too_slothful } }
        text = EVTDESC_MNM_3506_C
    }
    desc = {
        trigger = { FROM = { has_character_flag = sr_too_trusting } }
        text = EVTDESC_MNM_3506_D
    }
    desc = {
        trigger = { FROM = { has_character_flag = sr_too_indiscreet } }
        text = EVTDESC_MNM_3506_E
    }

    is_triggered_only = yes

    immediate = {
        clr_character_flag = free_help
        clr_character_flag = help_for_cost      
    }

    #Offer help freely
    option = { 
        name = EVTOPTA_MNM_3506
        custom_tooltip = { text = EVTOPTA_MNM_3506_TT }

        hidden_effect = {
            set_character_flag = free_help
            FROM = { character_event = { id = MNM.3507 } }
        }

        ai_chance = { 
            factor = 1 
            modifier = {
                factor = 3
                OR = {
                    trait = content
                    is_benevolent_trigger = yes
                    opinion = { who = FROM value = 50 }
                }
            }
        }
    }

    #Offer help for a cost
    option = {
        trigger = { FROM = { has_society_currency_minor_trigger = yes } }
        name = EVTOPTB_MNM_3506
        custom_tooltip = { text = EVTOPTB_MNM_3506_TT }

        hidden_effect = {
            set_character_flag = help_for_cost
            FROM = { character_event = { id = MNM.3507 } }
        }

        ai_chance = { 
            factor = 1 
            modifier = {
                factor = 3
                OR = {
                    trait = ambitious
                    trait = greedy
                    is_evil_trigger = yes
                    intrigue = 15
                }
            }
        }
    }

    #Do not help
    option = {
        name = EVTOPTC_MNM_3506
        custom_tooltip = { text = EVTOPTC_MNM_3506_TT }         

        ai_chance = { factor = 0 }

        hidden_effect = {
           FROM = {
                clr_character_flag = sr_too_honest
                clr_character_flag = sr_too_wroth
                clr_character_flag = sr_too_slothful
                clr_character_flag = sr_too_trusting
                clr_character_flag = sr_too_indiscreet
            } 
        }
    }
}

#I am offered help to hide my true religion
character_event = {     
    id = MNM.3507
    picture = GFX_evt_shady_meeting
    border = GFX_event_normal_frame_diplomacy

    is_triggered_only = yes

    trigger = { society_member_of = secret_religious_cult }

    desc = {
        trigger = { has_character_flag = sr_too_honest }
        text = EVTDESC_MNM_3507_A
    }
    desc = {
        trigger = { has_character_flag = sr_too_wroth }
        text = EVTDESC_MNM_3507_B
    }
    desc = {
        trigger = { has_character_flag = sr_too_slothful }
        text = EVTDESC_MNM_3507_C
    }
    desc = {
        trigger = { has_character_flag = sr_too_trusting }
        text = EVTDESC_MNM_3507_D
    }
    desc = {
        trigger = { has_character_flag = sr_too_indiscreet }
        text = EVTDESC_MNM_3507_E
    }

    option = { 
        trigger = { FROM = { has_character_flag = free_help } }
        name = EVTOPTA_MNM_3507
        custom_tooltip = { text = EVTOPTA_MNM_3507_TT }

        random_list = {
            50 = {
                modifier = { FROM = { intrigue = 12 } factor = 1.2 }
                modifier = { FROM = { intrigue = 14 } factor = 1.2 }
                modifier = { FROM = { intrigue = 16 } factor = 1.2 }
                modifier = { FROM = { intrigue = 18 } factor = 1.2 }
                modifier = { FROM = { intrigue = 20 } factor = 1.2 }

                custom_tooltip = { text = EVTOPT_MNM_3507_SUCCESS_TT }
                hidden_effect = { FROM = { character_event = { id = MNM.3508 days = 21 } } }

                tooltip = {
                    trigger_switch = {
                        on_trigger = has_character_flag 
                        sr_too_honest       = { remove_trait = honest }
                        sr_too_wroth        = { remove_trait = wroth }
                        sr_too_slothful     = { remove_trait = slothful }
                        sr_too_trusting     = { remove_trait = trusting }
                        sr_too_indiscreet   = { change_intrigue = 2 }
                    }
                }
            }
            50 = {
                custom_tooltip = { text = EVTOPT_MNM_3507_FAIL_TT }
                hidden_effect = { FROM = { character_event = { id = MNM.3509 days = 21 } } }
            }
        }

        reverse_opinion = {
            who = FROM
            modifier = opinion_took_my_advice
            years = 5
        }

        ai_chance = {
            factor = 10
            modifier = { FROM = { intrigue = 12 } factor = 1.2 }
            modifier = { FROM = { intrigue = 14 } factor = 1.2 }
            modifier = { FROM = { intrigue = 16 } factor = 1.2 }
            modifier = { FROM = { intrigue = 18 } factor = 1.2 }
            modifier = { FROM = { intrigue = 20 } factor = 1.2 }
        }
    }

    option = {
        trigger = { FROM = { has_character_flag = help_for_cost } }
        name = EVTOPTB_MNM_3507
        custom_tooltip = { text = EVTOPTB_MNM_3507_TT }

        detract_society_currency_minor_effect = yes

        random_list = {
            50 = {
                modifier = { FROM = { intrigue = 12 } factor = 1.2 }
                modifier = { FROM = { intrigue = 14 } factor = 1.2 }
                modifier = { FROM = { intrigue = 16 } factor = 1.2 }
                modifier = { FROM = { intrigue = 18 } factor = 1.2 }
                modifier = { FROM = { intrigue = 20 } factor = 1.2 }

                custom_tooltip = { text = EVTOPT_MNM_3507_SUCCESS_TT }
                hidden_effect = { FROM = { character_event = { id = MNM.3508 days = 21 } } }

                tooltip = {
                    trigger_switch = {
                        on_trigger = has_character_flag 
                        sr_too_honest       = { remove_trait = honest }
                        sr_too_wroth        = { remove_trait = wroth }
                        sr_too_slothful     = { remove_trait = slothful }
                        sr_too_trusting     = { remove_trait = trusting }
                        sr_too_indiscreet   = { change_intrigue = 2 }
                    }
                }
            }
            50 = {
                custom_tooltip = { text = EVTOPT_MNM_3507_FAIL_TT }
                hidden_effect = { FROM = { character_event = { id = MNM.3509 days = 21 } } }
            }
        }

        reverse_opinion = {
            who = FROM
            modifier = opinion_took_my_advice
            years = 5
        }

        ai_chance = {
            factor = 10
            modifier = { FROM = { intrigue = 12 } factor = 1.2 }
            modifier = { FROM = { intrigue = 14 } factor = 1.2 }
            modifier = { FROM = { intrigue = 16 } factor = 1.2 }
            modifier = { FROM = { intrigue = 18 } factor = 1.2 }
            modifier = { FROM = { intrigue = 20 } factor = 1.2 }
        }
    }
    
    option = {
        name = EVTOPTC_MNM_3507

        hidden_effect = { FROM = { character_event = { id = MNM.3510 days = 7 } } }

        reverse_opinion = {
            who = FROM
            modifier = opinion_did_not_take_my_advice
            years = 5
        }

        ai_chance = {
            factor = 5
        }
    }
}

#Successful help - giver
character_event = {
    id = MNM.3508
    desc = EVTDESC_MNM_3508
    picture = GFX_evt_shady_meeting
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    option = { 
        name = EXCELLENT
        custom_tooltip = { text = EVTOPTA_MNM_3508_TT }

        if = {
            limit = { has_character_flag = help_for_cost }
            add_society_currency_medium_effect = yes
        }

        tooltip = {
            FROM  = {
                trigger_switch = {
                    on_trigger = has_character_flag 
                    sr_too_honest       = { remove_trait = honest }
                    sr_too_wroth        = { remove_trait = wroth }
                    sr_too_slothful     = { remove_trait = slothful }
                    sr_too_trusting     = { remove_trait = trusting }
                    sr_too_indiscreet   = { change_intrigue = 2 }
                }
            }
        }

        hidden_effect = {
            clr_character_flag = free_help
            clr_character_flag = help_for_cost
            FROM  = { character_event = { id = MNM.3511 } }
        }
    }
}

#Unsuccessful help - giver
character_event = {
    id = MNM.3509
    desc = EVTDESC_MNM_3509
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3509

        if = {
            limit = { has_character_flag = help_for_cost }
            add_society_currency_medium_effect = yes
        }

        hidden_effect = {
            clr_character_flag = free_help
            clr_character_flag = help_for_cost
            FROM  = { character_event = { id = MNM.3512 } }
        }
    }
}

#They didn't want my help 
character_event = {
    id = MNM.3510
    desc = EVTDESC_MNM_3510
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3509

        opinion = {
            who = FROM
            modifier = opinion_did_not_take_my_advice
            years = 5
        }

        hidden_effect = { 
            clr_character_flag = free_help
            clr_character_flag = help_for_cost
            FROM = {
                clr_character_flag = sr_too_honest
                clr_character_flag = sr_too_wroth
                clr_character_flag = sr_too_slothful
                clr_character_flag = sr_too_trusting
                clr_character_flag = sr_too_indiscreet
            }
        }
    }
}

#Successful help - receiver
character_event = {
    id = MNM.3511
    desc = EVTDESC_MNM_3511
    picture = GFX_evt_secret_ceremony
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3511
        custom_tooltip = { text = EVTOPTA_MNM_3511_TT }

        trigger_switch = {
            on_trigger = has_character_flag 
            sr_too_honest       = { remove_trait = honest }
            sr_too_wroth        = { remove_trait = wroth }
            sr_too_slothful     = { remove_trait = slothful }
            sr_too_trusting     = { remove_trait = trusting }
            sr_too_indiscreet   = { change_intrigue = 2 }
        }

        hidden_effect = {
            decrease_visibility_effect = yes
            clr_character_flag = sr_too_honest
            clr_character_flag = sr_too_wroth
            clr_character_flag = sr_too_slothful
            clr_character_flag = sr_too_trusting
            clr_character_flag = sr_too_indiscreet
        }
    }
}


#Unsuccessful help - receiver
character_event = {
    id = MNM.3512
    desc = EVTDESC_MNM_3512
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3512

        hidden_effect = {
            clr_character_flag = sr_too_honest
            clr_character_flag = sr_too_wroth
            clr_character_flag = sr_too_slothful
            clr_character_flag = sr_too_trusting
            clr_character_flag = sr_too_indiscreet
        }
    }
}



###MISC###

#Misc: convert child to secret religion
#Ping event from child
character_event = {
	id = MNM.3429
	hide_window = yes
	
	is_triggered_only = yes

	trigger = {
		OR = {
			AND = {
				educator = { 
					has_secret_religion_trait_trigger = yes 
					NOT = { society_member_of = secret_religious_cult }
					any_ward = { character = PREV }
				}
			}
			guardian = { 
				has_secret_religion_trait_trigger = yes 
				NOT = { society_member_of = secret_religious_cult }
			}
			mother = { 
				has_secret_religion_trait_trigger = yes 
				NOT = { society_member_of = secret_religious_cult }
			}
			father = { 
				has_secret_religion_trait_trigger = yes 
				NOT = { society_member_of = secret_religious_cult }
			}
		}
	}

	immediate = {
		educator = {
			if = {
				limit = { has_secret_religion_trait_trigger = yes }
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		guardian = {
			if = {
				limit = { has_secret_religion_trait_trigger = yes }
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		mother = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_playable = yes
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		father = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_playable = yes
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		mother = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		father = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}
	}
	
	option = {
		event_target:secret_religion_influencer = { character_event = { id = MNM.3430 days = 3 random = 9 } } #todo days
	}
}

#Should I read my holy scripture to child?
character_event = {
    id = MNM.3430
    desc = EVTDESC_MNM_3430
    picture = GFX_evt_secluded_in_prayer
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    trigger = {
    	has_secret_religion_trait_trigger = yes
    	FROM = { 
    		has_secret_religion_trait_trigger = no 
    		has_prevs_secret_religion_truly_trigger = no
    	}
    }

    immediate = {
    
    }

    #Yes
    option = { 
        name = EVTOPTA_MNM_3430
        custom_tooltip = { text = EVTOPTA_MNM_3430_TT }

        hidden_effect = {
        	save_event_target_as = secret_religion_inductor
        	FROM = {
        		character_event = { id = MNM.3431 days = 1 }
        	}
        }
        ai_chance = { 
        	factor = 100 
        	modifier = { trait = brave factor = 3 }
        }
    }

    #No
    option = {
        name = EVTOPTB_MNM_3430
        custom_tooltip = { text = EVTOPTB_MNM_3430_TT }

        ai_chance = { 
        	factor = 20 
        	modifier = { trait = craven factor = 5 }
        	modifier = { trait = paranoid factor = 5 }
        	modifier = { trait = arbitrary factor = 5 }
        }
    }
}

#Child gets holy scripture read to them, do they like it?
character_event = { 
    id = MNM.3431
    picture = GFX_evt_secluded_in_prayer
    border = GFX_event_normal_frame_religion

    desc = {
    	trigger = { FROM = { shares_true_religion_group_with_prev_trigger = no } }
    	text = EVTDESC_MNM_3431_A
    }
    desc = {
    	trigger = { FROM = { shares_true_religion_group_with_prev_trigger = yes } }
    	text = EVTDESC_MNM_3431_B
    }

    is_triggered_only = yes
 
 	#tell me more
   	option = {
        name = EVTOPTC_MNM_3431

        FROM = { ROOT = { add_prevs_secret_religion_trait_effect = yes } }

        hidden_effect = { FROM = { character_event = { id = MNM.3432 days = 14 } } }

        ai_chance = {
        	factor = 20
        	modifier = { mother = { character = FROM } factor = 1.6 }
			modifier = { father = { character = FROM } factor = 1.6 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.6 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.2 }
        }
    }

    #this is stupid!
    option = {
        name = EVTOPTB_MNM_3431

        hidden_effect = { FROM = { character_event = { id = MNM.3434 days = 14 } } }

        ai_chance = {
        	factor = 40
        	modifier = { NOT = { opinion = { who = FROM value = 0 } } factor = 1.5 }
			modifier = { NOT = { opinion = { who = FROM value = -20 } } factor = 1.5 }
			modifier = { NOT = { opinion = { who = FROM value = -40 } } factor = 1.5 }
			modifier = { OR = { trait = zealous trait = idolizer } factor = 5 }
			modifier = { OR = { trait = willful trait = stubborn } factor = 1.5 }
			modifier = { OR = { trait = cynical trait = curious } factor = 1.5 }
			modifier = { FROM = { NOT = { diplomacy = 8 } } factor = 1.5 }
			modifier = { FROM = { NOT = { diplomacy = 6 } } factor = 1.5 }
        }
    }
}

#They seemed to like the holy scripture!
character_event = {
    id = MNM.3432
    desc = EVTDESC_MNM_3432
    picture = GFX_evt_child_reading
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3432
        tooltip = { FROM = { add_prevs_secret_religion_trait_effect = yes } }
    }
}

#They weren't impressed...
character_event = {
    id = MNM.3434
    desc = EVTDESC_MNM_3434
    picture = GFX_evt_child_play
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    #Try anyway
    option = { 
    	trigger = {
    		OR = {
    			trait = patient
    			NOT = { has_character_modifier = out_of_patience }
    		}
    	}

        name = EVTOPTA_MNM_3434

        tooltip = {
	        random_list = {
	        	60 = { #Success
	        		modifier = { mother = { character = ROOT } factor = 1.6 }
					modifier = { father = { character = ROOT } factor = 1.6 }
					modifier = { opinion = { who = ROOT value = 30 } factor = 1.5 }
					modifier = { opinion = { who = ROOT value = 50 } factor = 1.5 }
					modifier = { opinion = { who = ROOT value = 70 } factor = 1.6 }
					modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
					modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
					modifier = { ROOT = { diplomacy = 10 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 12 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 14 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 16 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 18 } factor = 1.2 }

					FROM = { add_prevs_secret_religion_trait_effect = yes }		
	        	}
	        	40 = { #Fail
	        		modifier = { NOT = { opinion = { who = ROOT value = 0 } } factor = 1.5 }
					modifier = { NOT = { opinion = { who = ROOT value = -20 } } factor = 1.5 }
					modifier = { NOT = { opinion = { who = ROOT value = -40 } } factor = 1.5 }
					modifier = { OR = { trait = zealous trait = idolizer } factor = 5 }
					modifier = { OR = { trait = willful trait = stubborn } factor = 1.5 }
					modifier = { OR = { trait = cynical trait = curious } factor = 1.5 }
					modifier = { ROOT = { NOT = { diplomacy = 8 } } factor = 1.5 }
					modifier = { ROOT = { NOT = { diplomacy = 6 } } factor = 1.5 }

					FROM = {
						if = {
							limit = {
								NOT = { trait = zealous }
								NOT = { has_dlc = Zeus }
							}
							add_trait = zealous
						}
						if = {
							limit = {
								NOT = { trait = idolizer }
								has_dlc = Zeus
							}
							add_trait = idolizer
						}
						add_rival = ROOT
					}
	        	}
	        }
        }

        if = {
        	limit = { NOT = { trait = patient } }
	        add_character_modifier = {
	        	name = out_of_patience 
	        	years = 3
	        }
        }

        hidden_effect = {
        	FROM = { character_event = { id = MNM.3435 days = 1 } }
        }

        ai_chance = { 
        	factor = 20
        	modifier = { any_child = { character = ROOT } factor = 5 }
        	modifier = { current_heir = { character = ROOT } factor = 5 }
        }
    }

    #Let it be
    option = {
    	name = EVTOPTB_MNM_3434

        ai_chance = { 
        	factor = 80
        }
    }
}

#They're trying to force the scripture on me again
character_event = {
    id = MNM.3435
    desc = EVTDESC_MNM_3435
    picture = GFX_evt_child_reading
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3435

        FROM = { ROOT = { add_prevs_secret_religion_trait_effect = yes } }

        hidden_effect = { FROM = { character_event = { id = MNM.3436 days = 14 } } }

        ai_chance = {
        	factor = 60
        	modifier = { mother = { character = FROM } factor = 1.6 }
			modifier = { father = { character = FROM } factor = 1.6 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.6 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.2 }
        }
    }

    option = {
        name = EVTOPTB_MNM_3435

        if = {
			limit = {
				NOT = { trait = zealous }
				NOT = { has_dlc = Zeus }
			}
			add_trait = zealous
		}
		if = {
			limit = {
				NOT = { trait = idolizer }
				has_dlc = Zeus
			}
			add_trait = idolizer
		}

		add_rival = FROM

		hidden_effect = { FROM = { character_event = { id = MNM.3437 days = 14 } } }

        ai_chance = {
        	factor = 60
        	modifier = { mother = { character = FROM } factor = 1.6 }
			modifier = { father = { character = FROM } factor = 1.6 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.6 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.2 }
        }
    }
}

#It worked out, in the end!
character_event = {
    id = MNM.3436
    desc = EVTDESC_MNM_3436
    picture = GFX_evt_child_reading
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3436
        tooltip = { FROM = { add_prevs_secret_religion_trait_effect = yes } }
    }
}

#I failed and now they are zealous
character_event = {
    id = MNM.3437
    desc = EVTDESC_MNM_3437
    picture = GFX_evt_child_sword
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3412
        tooltip = {
        	FROM  =	{
        		if = {
					limit = {
						NOT = { trait = zealous }
						NOT = { has_dlc = Zeus }
					}
					add_trait = zealous
				}
				if = {
					limit = {
						NOT = { trait = idolizer }
						has_dlc = Zeus
					}
					add_trait = idolizer
				}

				add_rival = ROOT
        	}
        }
    }
}

#Parent/educator/guardian ping event for the decision
character_event = {
	id = MNM.3438
	hide_window = yes
	is_triggered_only = yes
	immediate = { FROM = { character_event = { id = MNM.3431 } } }
}

# personally_openly_adopt_faith - inform liege
character_event = {
	id = MNM.3840
	desc = EVTDESC_MNM_3840
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3840
	}
}

# prepare_grounds - safety flag clear
character_event = {
	id = MNM.3849
	hide_window = yes
	is_triggered_only = yes
	immediate = { clr_character_flag = preparing_grounds_in_@FROM }
}

# prepare_grounds - Start progress
character_event = {
	id = MNM.3850
	desc = EVTDESC_MNM_3850
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3850
		custom_tooltip = {
			text = EVTTOOLTIP_MNM_3850
			hidden_effect = {
				random_list = {
					20 = {
						modifier = {
							factor = 0.1
							event_target:target_province = {
								holder_scope = {
									NOT = {
										character = ROOT
									}
								}
							}
						}
						modifier = {
							factor = 1.1
							diplomacy = 12
						}
						modifier = {
							factor = 1.1
							diplomacy = 14
						}
						modifier = {
							factor = 1.1
							diplomacy = 16
						}
						modifier = {
							factor = 1.1
							diplomacy = 18
						}
						modifier = {
							factor = 1.1
							diplomacy = 20
						}
						
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										NOT = {
											character = ROOT
										}
									}
								}
							}
							character_event = { id = MNM.3860 days = 500 random = 50 }
						}
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										character = ROOT
									}
								}
							}
							character_event = { id = MNM.3860 days = 300 random = 50 }
						}
					}
					50 = {
						modifier = {
							factor = 0.2
							event_target:target_province = {
								holder_scope = {
									NOT = {
										character = ROOT
									}
								}
							}
						}
						modifier = {
							factor = 1.1
							diplomacy = 12
						}
						modifier = {
							factor = 1.1
							diplomacy = 14
						}
						modifier = {
							factor = 1.1
							diplomacy = 16
						}
						modifier = {
							factor = 1.1
							diplomacy = 18
						}
						modifier = {
							factor = 1.1
							diplomacy = 20
						}
						
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										NOT = {
											character = ROOT
										}
									}
								}
							}
							character_event = { id = MNM.3870 days = 500 random = 50 }
						}
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										character = ROOT
									}
								}
							}
							character_event = { id = MNM.3870 days = 300 random = 50 }
						}
					}
					30 = {
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										NOT = {
											character = ROOT
										}
									}
								}
							}
							character_event = { id = MNM.3880 days = 500 random = 50 }
						}
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										character = ROOT
									}
								}
							}
							character_event = { id = MNM.3880 days = 300 random = 50 }
						}
					}
				}
			}
		}
		character_event = { id = MNM.3859 days = 30 }
	}
}

character_event = {
	id = MNM.3858
	desc = EVTDESC_MNM_3858
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3858
		if = {
			limit = {
				has_quest = quest_secret_religions_societies_prepare_grounds
				event_target:target_province = {
					is_quest_target_of = ROOT
				}
			}
			clr_quest = { id = quest_secret_religions_societies_prepare_grounds failure = yes }
		}
		clear_delayed_event = { id = MNM.3849 }
		clear_delayed_event = { id = MNM.3859 }
		clr_character_flag = preparing_grounds_in_@target_province
	}
}

character_event = {
	id = MNM.3859
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				#OR = {
				#	NOT = {
				#		society = {
				#			event_target:original_society = {
				#				society_type = PREV
				#			}
				#		}
				#	}
					event_target:target_province = {
						county = {
							holder_scope = {
								NOT = { 
									same_realm = ROOT
								}
							}
						}
					}
				#}
			}
			clear_delayed_event = { id = MNM.3860 }
			clear_delayed_event = { id = MNM.3870 }
			clear_delayed_event = { id = MNM.3880 }
			clear_delayed_event = { id = MNM.3890 }
			character_event = { id = MNM.3858 }
			break = yes
		}
		repeat_event = { id = MNM.3859 days = 30 }
	}
}

character_event = {
	id = MNM.3860
	desc = EVTDESC_MNM_3860
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3860
		hidden_effect = {
			character_event = { id = MNM.3890 days = 150 random = 50 }
		}
	}
}

character_event = {
	id = MNM.3870
	desc = EVTDESC_MNM_3870
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3870
		hidden_effect = {
			character_event = { id = MNM.3890 days = 350 random = 50 }
		}
	}
}

character_event = {
	id = MNM.3880
	desc = EVTDESC_MNM_3880
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3880
		scaled_wealth = {
			value = -0.3
			min = -50
			max = -250
		}
		hidden_effect = {
			character_event = { id = MNM.3890 days = 450 random = 50 }
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3880
		if = {
			limit = {
				has_quest = quest_secret_religions_societies_prepare_grounds
				event_target:target_province = {
					is_quest_target_of = ROOT
				}
			}
			clr_quest = { id = quest_secret_religions_societies_prepare_grounds failure = yes }
		}
		hidden_effect = {
			clear_delayed_event = { id = MNM.3859 }
			clear_delayed_event = { id = MNM.3849 }
			clr_character_flag = preparing_grounds_in_@target_province
		}
	}
}

character_event = {
	id = MNM.3890
	desc = EVTDESC_MNM_3890
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3890
		trigger_switch = {
			on_trigger = secret_religion
			#secret religions
		}
		if = {
			limit = {
				has_quest = quest_secret_religions_societies_prepare_grounds
				event_target:target_province = {
					is_quest_target_of = ROOT
				}
			}
			clr_quest = quest_secret_religions_societies_prepare_grounds
			
			add_society_currency_minor_effect = yes
		}
		clear_delayed_event = { id = MNM.3849 }
		clr_character_flag = preparing_grounds_in_@target_province
		
		hidden_effect = {
			clear_delayed_event = { id = MNM.3859 }
		}
	}
}

character_event = {
	id = MNM.3900
	hide_window = yes

	is_triggered_only = yes

	immediate = { FROM = { society_quest_event = { id = MNM.3901 days = 7 random = 7 } } }
}

society_quest_event = {
	id = MNM.3901
    border = GFX_event_letter_frame_religion

    desc = EVTDESC_MNM_3901

    is_triggered_only = yes
	
	immediate = {
		random_demesne_province = {
			limit = {
				OR = {
                    #Check if target province is not of the religion to which it will prepare grounds
                }
			}
			save_event_target_as = target_province
		}
	}

    option = {
        name = ACCEPT
		event_target:target_province = {
			set_quest_target = {
				id = quest_secret_religions_societies_prepare_grounds
				holder = ROOT
			}
		}
    }

    option = {
        name = DECLINE
        custom_tooltip = { text = decline_quest_tooltip }

        add_character_modifier = {
            name = quest_cooldown_timer
            hidden = yes
            days = 1000
        }

        ai_chance = { factor = 0 }
    }
}


#Character gets option to secretly keep old religion
character_event = {
    id = MNM.3949
    desc = EVTDESC_MNM_3949
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    hide_from = yes
    
    trigger = {
        has_secret_religion_trait_trigger = no
        has_any_char_old_religion = yes
    }

    immediate = {
        event_target_old_religion_from_flag_effect = yes
        FROM = { FROMFROM = { save_event_target_as = demander } }
    }

    option = {
        name = EVTOPTA_MNM_3949
        ai_chance = {
            factor = 50
            modifier = {
                trait = zealous 
                factor = 1.5
            }
            modifier = {
                trait = brave 
                factor = 1.5
            }
            modifier = {
                OR = {
                    AND = {
                        has_character_flag = character_was_arcane
                        liege = { secret_religion = arcane }
                    }
					AND = {
                        has_character_flag = character_was_sunwell
                        liege = { secret_religion = sunwell }
                    }
					AND = {
                        has_character_flag = character_was_lifebinder
                        liege = { secret_religion = cult_of_the_life_binder }
                    }
					AND = {
                        has_character_flag = character_was_spellweaver
                        liege = { secret_religion = cult_of_the_spell_weaver }
                    }
					AND = {
                        has_character_flag = character_was_dreamer
                        liege = { secret_religion = cult_of_the_dreamer }
                    }
                    AND = {
                        has_character_flag = character_was_timeless
                        liege = { secret_religion = cult_of_the_timeless }
                    }
					AND = {
                        has_character_flag = character_was_destroyer
                        liege = { secret_religion = cult_of_the_destroyer }
                    }
					AND = {
                        has_character_flag = character_was_earthwarder
                        liege = { secret_religion = cult_of_the_earth_warder }
                    }
					AND = {
                        has_character_flag = character_was_infinite
                        liege = { secret_religion = cult_of_the_infinite }
                    }
					AND = {
                        has_character_flag = character_was_nightmare
                        liege = { secret_religion = emerald_nightmare }
                    }
					AND = {
                        has_character_flag = character_was_shamanism
                        liege = { secret_religion = shamanism }
                    }
					AND = {
                        has_character_flag = character_was_aeromancy
                        liege = { secret_religion = aeromancy }
                    }
					AND = {
                        has_character_flag = character_was_geomancy
                        liege = { secret_religion = geomancy }
                    }
					AND = {
                        has_character_flag = character_was_hydromancy
                        liege = { secret_religion = hydromancy }
                    }
                    AND = {
                        has_character_flag = character_was_pyromancy
                        liege = { secret_religion = pyromancy }
                    }
					AND = {
                        has_character_flag = character_was_oldways
                        liege = { secret_religion = old_ways }
                    }
					AND = {
                        has_character_flag = character_was_legion
                        liege = { secret_religion = burning_legion }
                    }
					AND = {
                        has_character_flag = character_was_demonology
                        liege = { secret_religion = demonology }
                    }
					AND = {
                        has_character_flag = character_was_lichking
                        liege = { secret_religion = lich_king }
                    }
                    AND = {
                        has_character_flag = character_was_mercantilism
                        liege = { secret_religion = mercantilism }
                    }
					AND = {
                        has_character_flag = character_was_holylight
                        liege = { secret_religion = holy_light }
                    }
					AND = {
                        has_character_flag = character_was_scarlet
                        liege = { secret_religion = scarlet }
                    }
                    AND = {
                        has_character_flag = character_was_argent
                        liege = { secret_religion = argent }
                    }
					AND = {
                        has_character_flag = character_was_shadow
                        liege = { secret_religion = forgotten_shadow }
                    }
					AND = {
                        has_character_flag = character_was_oldgods
                        liege = { secret_religion = old_gods }
                    }
                    AND = {
                        has_character_flag = character_was_twilight
                        liege = { secret_religion = twilights_hammer }
                    }
					AND = {
                        has_character_flag = character_was_azshara
                        liege = { secret_religion = azshara }
                    }
					AND = {
                        has_character_flag = character_was_loa
                        liege = { secret_religion = loa }
                    }
                    AND = {
                        has_character_flag = character_was_hakkar
                        liege = { secret_religion = hakkar }
                    }
                }
                factor = 500
            }
        }
		add_secret_religion_trait_trigger_is_religion_or_old_religion_flag_clear_flag_after_effect_is_run_this_name_is_a_tribute_to_m_effect = yes
        custom_tooltip = { text = EVTOPTA_MNM_3949_TT }
    }

    option = {
        name = EVTOPTB_MNM_3949
        ai_chance = {
            factor = 50
            modifier = {
                factor = 0.3
                trait = craven 
            }
        }
        custom_tooltip = { text = EVTOPTB_MNM_3949_TT }
    }    
}

# Secret religion - Member thinks it's too stressful to keep practising their secret religion.
character_event = {
	id = MNM.3920
	desc = EVTDESC_MNM_3920
	picture = "GFX_evt_uncomfortable"
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
	
	only_playable = yes
	is_in_society = yes
	
	trigger = {
		society_member_of = secret_religious_cult
		block_general_event_trigger = no
		
		society = {
			any_society_member = {
				ai = yes
				NOT = { character = ROOT }
				NOT = { is_society_grandmaster = yes }
				
				is_within_diplo_range = ROOT
			}
		}
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 0.05
			ai = yes
		}
		modifier = {
			factor = 2
			society = {
				any_society_member = {
					OR = {
						trait = paranoid
						trait = stressed
					}
				}
			}
		}
		modifier = {
			factor = 2
			society = {
				any_society_member = {
					count = 5
					OR = {
						trait = paranoid
						trait = stressed
					}
				}
			}
		}
		modifier = {
			factor = 2
			society = {
				any_society_member = {
					count = 10
					OR = {
						trait = paranoid
						trait = stressed
					}
				}
			}
		}
	}
	
	immediate = {
		# Find a suitable person
		society = {
			random_society_member = {
				limit = {
					ai = yes
					NOT = { character = ROOT }
					NOT = { is_society_grandmaster = yes }
					same_realm = ROOT
					OR = {
						trait = paranoid
						trait = stressed
					}
					
					is_within_diplo_range = ROOT
				}
				save_event_target_as = worried_secret_member
			}
			if = {
				limit = {
					NOT = { event_target:worried_secret_member = { always = yes } }
				}
				random_society_member = {
					limit = {
						ai = yes
						NOT = { character = ROOT }
						NOT = { is_society_grandmaster = yes }
						same_realm = ROOT
						
						is_within_diplo_range = ROOT
					}
					save_event_target_as = worried_secret_member
				}
			}
			if = {
				limit = {
					NOT = { event_target:worried_secret_member = { always = yes } }
				}
				random_society_member = {
					limit = {
						ai = yes
						NOT = { character = ROOT }
						NOT = { is_society_grandmaster = yes }
						OR = {
							trait = paranoid
							trait = stressed
						}
						
						is_within_diplo_range = ROOT
					}
					save_event_target_as = worried_secret_member
				}
			}
			if = {
				limit = {
					NOT = { event_target:worried_secret_member = { always = yes } }
				}
				random_society_member = {
					limit = {
						ai = yes
						NOT = { character = ROOT }
						NOT = { is_society_grandmaster = yes }
						
						is_within_diplo_range = ROOT
					}
					save_event_target_as = worried_secret_member
				}
			}
		}
	}
	
	option = { # Try to convince by talking about solidarity
		name = EVTOPTA_MNM_3920
		hidden_effect = {
			random_list = {
				40 = { # Success
					modifier = {
						factor = 1.3
						diplomacy = 9
					}
					modifier = {
						factor = 1.3
						diplomacy = 11
					}
					modifier = {
						factor = 1.3
						diplomacy = 13
					}
					modifier = {
						factor = 1.3
						diplomacy = 15
					}
					modifier = {
						factor = 1.3
						diplomacy = 17
					}
					modifier = {
						factor = 1.3
						diplomacy = 19
					}
					modifier = {
						factor = 2
						FROM = { trait = charitable }
					}
					modifier = {
						factor = 2
						FROM = { trait = kind }
					}
					modifier = {
						factor = 2
						FROM = { trait = honest }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = craven }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = cynical }
					}
					
					set_character_flag = solidarity_success
				}
				20 = { # Failure
					modifier = { # ai can't deem what would be a good choice
						factor = 0.5
						ai = yes
					}
					set_character_flag = solidarity_failure
				}
			}
			character_event = { id = MNM.3921 days = 14 }
		}
	}
	
	option = { # Try to convince by talking about devotion
		name = EVTOPTB_MNM_3920
		hidden_effect = {
			random_list = {
				40 = { # Success
					modifier = {
						factor = 1.3
						diplomacy = 9
					}
					modifier = {
						factor = 1.3
						diplomacy = 11
					}
					modifier = {
						factor = 1.3
						diplomacy = 13
					}
					modifier = {
						factor = 1.3
						diplomacy = 15
					}
					modifier = {
						factor = 1.3
						diplomacy = 17
					}
					modifier = {
						factor = 1.3
						diplomacy = 19
					}
					modifier = {
						factor = 2
						FROM = { trait = patient }
					}
					modifier = {
						factor = 2
						FROM = { trait = diligent }
					}
					modifier = {
						factor = 2
						FROM = { trait = brave }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = paranoid }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = arbitrary }
					}
					
					set_character_flag = devotion_success
				}
				20 = { # Failure
					modifier = { # ai can't deem what would be a good choice
						factor = 0.5
						ai = yes
					}
					set_character_flag = devotion_failure
				}
			}
			character_event = { id = MNM.3921 days = 14 }
		}
	}
	
	option = { # Use smooth talking to calm her
		name = EVTOPTC_MNM_3920
		trigger = {
			trait = gregarious
		}
		tooltip_info = gregarious
		
		hidden_effect = {
			set_character_flag = gregarious_success
			character_event = { id = MNM.3921 days = 14 }
		}
	}
	
	option = { # She is free to leave if she feels that way
		name = EVTOPTD_MNM_3920
		event_target:worried_secret_member = {
			leave_society = yes
			clear_secret_religion = yes
		}
	}
}

character_event = {
    id = MNM.3921
    picture = "GFX_evt_uncomfortable"
    border = GFX_event_normal_frame_religion
    is_triggered_only = yes

    trigger = { society_member_of = secret_religious_cult }
    
    desc = {
        text = EVTDESC_MNM_3921_A
        trigger = { has_character_flag = solidarity_success }
    }
    desc = {
        text = EVTDESC_MNM_3921_B
        trigger = { has_character_flag = solidarity_failure }
    }
    desc = {
        text = EVTDESC_MNM_3921_C
        trigger = { has_character_flag = devotion_success }
    }
    desc = {
        text = EVTDESC_MNM_3921_D
        trigger = { has_character_flag = devotion_failure }
    }
    desc = {
        text = EVTDESC_MNM_3921_E
        trigger = { has_character_flag = gregarious_success }
    }
	
	option = {
		name = EVTOPTA_MNM_3921
		trigger = {
			OR = {
				has_character_flag = solidarity_success
				has_character_flag = devotion_success
				has_character_flag = gregarious_success
			}
		}
		if = {
			limit = {
				has_character_flag = gregarious_success
				FROM = {
					trait = paranoid
				}
			}
			FROM = {
				remove_trait = paranoid
			}
		}
		if = {
			limit = {
				has_character_flag = gregarious_success
				FROM = {
					trait = stressed
				}
			}
			FROM = {
				remove_trait = stressed
			}
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3921
		trigger = {
			NOR = {
				has_character_flag = solidarity_success
				has_character_flag = devotion_success
				has_character_flag = gregarious_success
			}
		}
		event_target:worried_secret_member = {
			leave_society = yes
			clear_secret_religion = yes
		}
	}
}

### Secret religions - commission painting
character_event = {
	id = MNM.3910
	desc = EVTDESC_MNM_3910
	picture = GFX_evt_dharmic_pilgrims
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
	
	only_playable = yes
	
	trigger = {
		NOT = { has_character_flag = commissioned_painting }
		block_general_event_trigger = no
		OR = {
			is_in_society = no
			NOT = { society_member_of = secret_religious_cult }
			society = {
				any_society_member = {
					NOT = { character = ROOT }
					same_realm = ROOT
				}
			}
		}
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 0.05
			NOT = { society_member_of = secret_religious_cult }
		}
	}
	
	immediate = {
		set_character_flag = commissioned_painting
	}
	
	option = {
		name = EVTOPTA_MNM_3910
		
		scaled_wealth = {
			value = -0.3
			min = -25
			max = -125
		}
		hidden_effect = {
			character_event = { id = MNM.3911 days = 60 random = 20 }
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3910
	}
}

# Add hidden religious symbols to the painting?
character_event = {
	id = MNM.3911
	desc = EVTDESC_MNM_3911
	picture = GFX_evt_dharmic_pilgrims
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = { # Ask artist to add symbols
		name = EVTOPTA_MNM_3911
		trigger = {
			society_member_of = secret_religious_cult
		}
		
		scaled_wealth = {
			value = -0.05
			min = -5
			max = -30
		}
		if = {
			limit = { random = 50 }
			custom_tooltip = {
				text = EVTTOOLTIPA_MNM_3911_FEMALE
				random_list = {
					95 = {
						hidden_effect = {
							character_event = { id = MNM.3912 days = 25 random = 5 }
						}
					}
					5 = {
						add_character_modifier = {
							modifier = unfaithful_rumors
							years = 3
						}
						scaled_wealth = {
							value = -0.05
							min = -5
							max = -30
						}
					}
				}
			}
		}
		if = {
			limit = { NOT = { random = 50 } }
			custom_tooltip = {
				text = EVTTOOLTIPA_MNM_3911_MALE
				random_list = {
					95 = {
						hidden_effect = {
							character_event = { id = MNM.3912 days = 25 random = 5 }
						}
					}
					5 = {
						add_character_modifier = {
							modifier = unfaithful_rumors
							years = 3
						}
						scaled_wealth = {
							value = -0.05
							min = -5
							max = -30
						}
					}
				}
			}
		}
	}
	
	option = { # Add symbols yourself
		name = EVTOPTB_MNM_3911
		trigger = {
			society_member_of = secret_religious_cult
		}
		
		custom_tooltip = {
			text = EVTTOOLTIPB_MNM_3911
			hidden_effect = {
				random_list = {
					60 = { # Success
						character_event = { id = MNM.3912 days = 35 random = 10 }
					}
					40 = { # Avant Garde
						character_event = { id = MNM.3914 days = 35 random = 10 }
					}
				}
			}
		}
	}
	
	option = { # Keep as is
		name = EVTOPTC_MNM_3911
		add_artifact = magnificent_painting
	}
}

character_event = {
	id = MNM.3912
	desc = EVTDESC_MNM_3912
	picture = GFX_evt_ritual_scroll
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		society = {
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					same_realm = ROOT
					OR = {
						AND = {
							society_rank > 1
							ROOT = { society_rank == 1 }
						}
						AND = {
							society_rank > 2
							ROOT = { society_rank == 2 }
						}
						AND = {
							society_rank > 3
							ROOT = { society_rank == 3 }
						}
					}
				}
				save_event_target_as = society_art_observer
			}
			if = {
				limit = {
					NOT = { event_target:society_art_observer = { always = yes } }
				}
				random_society_member = {
					limit = {
						NOT = { character = ROOT }
						same_realm = ROOT
					}
					save_event_target_as = society_art_observer
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_3912
		add_artifact = magnificent_painting
		add_society_currency_minor_effect = yes
		
		event_target:society_art_observer = {
			opinion = {
				who = ROOT
				modifier = opinion_budding_friendship
				years = 10
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_budding_friendship
				years = 10
			}
		}
	}
}

character_event = {
	id = MNM.3914
	desc = EVTDESC_MNM_3914
	picture = GFX_evt_ritual_scroll
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_3914
		add_artifact = avant_garde_painting
	}
	
	option = {
		name = EVTOPTB_3914
		prestige = -100
	}
}

### Fellow society member asks you to go for a round of drinks
character_event = {
	id = MNM.3930
	desc = EVTDESC_MNM_3930
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	is_in_society = yes
	
	trigger = {
		block_general_event_trigger = no
		society_member_of = secret_religious_cult
		
		society = {
			any_society_member = {
				NOT = { character = ROOT }
				ai = yes
			}
		}
	}
	
	immediate = {
		society = {
			
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					ai = yes
					same_realm = ROOT
				}
				save_event_target_as = society_character
			}
			if = {
				limit = { NOT = { event_target:society_character = { always = yes } } }				
				random_society_member = {
					limit = {
						NOT = {	character = ROOT }
						ai = yes
					}
					save_event_target_as = society_character
				}
			}
		}
	}
	
	option = { # Of course
		name = EVTOPTA_3930
		custom_tooltip = {
			text = EVTTOOLTIP_MNM_3930
			hidden_effect = {
				event_target:society_character = {
					character_event = { id = MNM.3931 }
				}
			}
		}
	}
	
	option = { # I don't have time for that
		name = EVTOPTB_3930
	}
}

character_event = {
	id = MNM.3931
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		FROM = {
			character_event = { id = MNM.3932 days = 21 random = 7 }
		}
	}
}

# Argument with local
character_event = {
	id = MNM.3932
	desc = EVTDESC_MNM_3932
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
    
    trigger = { society_member_of = secret_religious_cult }

	
	option = { # diplomatically calm the situation
		name = EVTOPTA_MNM_3932
		custom_tooltip = {
			text = EVTTOOLTIPA_MNM_3932
			hidden_effect = {
				character_event = { id = MNM.3933 days = 7 }
			}
		}
	}
	
	option = { # fight the local
		name = EVTOPTB_MNM_3932
		custom_tooltip = {
			text = EVTTOOLTIPB_MNM_3932
			hidden_effect = {
				character_event = { id = MNM.3934 days = 7 }
			}
		}
	}
}

character_event = {
	id = MNM.3933
	desc = {
		text = EVTDESC_MNM_3933_SUCCESS
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
	}
	desc = {
		text = EVTDESC_MNM_3933_FAILURE
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
	}
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_list = { # Diplomacy check
			30 = { # success
				modifier = {
					factor = 1.3
					diplomacy = 7
				}
				modifier = {
					factor = 1.3
					diplomacy = 9
				}
				modifier = {
					factor = 1.3
					diplomacy = 11
				}
				modifier = {
					factor = 1.3
					diplomacy = 13
				}
			
			
				set_character_flag = sr_bar_fight_success
			}
			70 = { # failure
			}
		}
	}
	
	option = {
		name = EVTOPTA_MNM_3933
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
		
		add_character_modifier = {
			modifier = mediator
			years = 2
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3933
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
		
		if = {
			limit = {
				OR = {
					trait = wounded
					trait = maimed
				}
			}
			prestige = -50
		}
		if = {
			limit = {
				NOR = {
					trait = wounded
					trait = maimed
				}
			}
			add_trait = wounded
		}
		event_target:society_character = {
			if = {
				limit = {
					OR = {
						trait = wounded
						trait = maimed
					}
				}
				prestige = -50
			}
			if = {
				limit = {
					NOR = {
						trait = wounded
						trait = maimed
					}
				}
				add_trait = wounded
			}
		}
		add_character_modifier = {
			modifier = bruised_knuckles
			months = 6
		}
	}
	
	after = {
		clr_character_flag = sr_bar_fight_success
		event_target:society_character = {
			opinion = {
				who = ROOT
				modifier = opinion_happy
				years = 5
			}
			hidden_effect = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_happy
					years = 5
				}
			}
		}
	}
}

character_event = {
	id = MNM.3934
	desc = {
		text = EVTDESC_MNM_3934_SUCCESS
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
	}
	desc = {
		text = EVTDESC_MNM_3934_FAILURE
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
	}
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_list = { # Martial check
			30 = { # success
				modifier = {
					factor = 1.3
					martial = 7
				}
				modifier = {
					factor = 1.3
					martial = 9
				}
				modifier = {
					factor = 1.3
					martial = 11
				}
				modifier = {
					factor = 1.3
					martial = 13
				}
			
				set_character_flag = sr_bar_fight_success
			}
			70 = { # failure
			}
		}
	}
	
	option = {
		name = EVTOPTA_MNM_3934
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
		
		change_society_currency = 30
		increase_visibility_effect = yes
	}
	
	option = {
		name = EVTOPTB_MNM_3934
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
		
		increase_visibility_effect = yes
		if = {
			limit = {
				OR = {
					trait = wounded
					trait = maimed
				}
			}
			prestige = -50
		}
		if = {
			limit = {
				NOR = {
					trait = wounded
					trait = maimed
				}
			}
			add_trait = wounded
		}
		event_target:society_character = {
			if = {
				limit = {
					OR = {
						trait = wounded
						trait = maimed
					}
				}
				prestige = -50
			}
			if = {
				limit = {
					NOR = {
						trait = wounded
						trait = maimed
					}
				}
				add_trait = wounded
			}
		}
	}
	
	after = {
		add_character_modifier = {
			modifier = bruised_knuckles
			months = 6
		}
		event_target:society_character = {
			opinion = {
				who = ROOT
				modifier = opinion_happy
				years = 5
			}
			hidden_effect = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_happy
					years = 5
				}
			}
		}
		clr_character_flag = sr_bar_fight_success
	}
}

# Feedback event for found_religious_cult decision
character_event = {
	id = MNM.3950
	desc = EVTDESC_MNM_3950
	picture = GFX_evt_secret_ceremony
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3950
	}
}

# Feedback event for falsely_confess_faith decision
character_event = {
	id = MNM.3951
	desc = EVTDESC_MNM_3951
	picture = GFX_evt_secluded_in_prayer
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3951
	}
}

# rare ai only - secretly convert from spouse/friend/province's religion
character_event = {
	id = MNM.3948
	hide_window = yes
	
	is_triggered_only = yes
	
	ai = yes
	only_playable = yes
	
	trigger = {
		has_secret_religion = no
		any_spouse = {
			same_true_religion_as_root_trigger = no
		}
		any_consort = {
			same_true_religion_as_root_trigger = no
		}
		any_demesne_province = {
			NOT = { religion = { target_type = true target = ROOT} }
		}
		any_friend = {
			same_true_religion_as_root_trigger = no
		}
	}
	
	weight_multiplier = {
		days = 1
	}
	
	immediate = {
		random_spouse = {
			limit = {
				same_true_religion_as_root_trigger = no
			}
			ROOT = { 
				set_secret_religion = { target_type = true target = PREV }
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
			}
			break = yes
		}
		random_consort = {
			limit = {
				same_true_religion_as_root_trigger = no
			}
			ROOT = { 
				set_secret_religion = { target_type = true target = PREV }
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
			}
			break = yes
		}
		random_demesne_province = {
			limit = {
				NOT = { religion = { target_type = true target = ROOT} }
			}
			ROOT = { set_secret_religion = { target_type = public target = PREV } }
			ROOT = {
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
					}
					set_secret_religion = { target_type = true target = ROOT }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
					}
					set_secret_religion = { target_type = true target = ROOT }
				}
			}
			break = yes
		}
		random_friend = {
			limit = {
				same_true_religion_as_root_trigger = no
			}
			ROOT = { 
				set_secret_religion = { target_type = true target = PREV }
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
			}
			break = yes
		}
	}
}
